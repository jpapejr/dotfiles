"use strict";var oo=Object.create;var xt=Object.defineProperty;var ao=Object.getOwnPropertyDescriptor;var co=Object.getOwnPropertyNames;var ho=Object.getPrototypeOf,uo=Object.prototype.hasOwnProperty;var I=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),lo=(t,e)=>{for(var r in e)xt(t,r,{get:e[r],enumerable:!0})},wn=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of co(e))!uo.call(t,s)&&s!==r&&xt(t,s,{get:()=>e[s],enumerable:!(n=ao(e,s))||n.enumerable});return t};var N=(t,e,r)=>(r=t!=null?oo(ho(t)):{},wn(e||!t||!t.__esModule?xt(r,"default",{value:t,enumerable:!0}):r,t)),mo=t=>wn(xt({},"__esModule",{value:!0}),t);var In=I(er=>{"use strict";er.toString=function(t){switch(t){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+t};er.toType=function(t){switch(t.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":return 255;case"*":return 255}return t.toUpperCase().startsWith("UNKNOWN_")?parseInt(t.slice(8)):0}});var Tn=I(tr=>{"use strict";tr.toString=function(t){switch(t){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+t};tr.toRcode=function(t){switch(t.toUpperCase()){case"NOERROR":return 0;case"FORMERR":return 1;case"SERVFAIL":return 2;case"NXDOMAIN":return 3;case"NOTIMP":return 4;case"REFUSED":return 5;case"YXDOMAIN":return 6;case"YXRRSET":return 7;case"NXRRSET":return 8;case"NOTAUTH":return 9;case"NOTZONE":return 10;case"RCODE_11":return 11;case"RCODE_12":return 12;case"RCODE_13":return 13;case"RCODE_14":return 14;case"RCODE_15":return 15}return 0}});var Rn=I(rr=>{"use strict";rr.toString=function(t){switch(t){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+t};rr.toOpcode=function(t){switch(t.toUpperCase()){case"QUERY":return 0;case"IQUERY":return 1;case"STATUS":return 2;case"OPCODE_3":return 3;case"NOTIFY":return 4;case"UPDATE":return 5;case"OPCODE_6":return 6;case"OPCODE_7":return 7;case"OPCODE_8":return 8;case"OPCODE_9":return 9;case"OPCODE_10":return 10;case"OPCODE_11":return 11;case"OPCODE_12":return 12;case"OPCODE_13":return 13;case"OPCODE_14":return 14;case"OPCODE_15":return 15}return 0}});var Pn=I(nr=>{"use strict";nr.toString=function(t){switch(t){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+t};nr.toClass=function(t){switch(t.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}});var An=I(sr=>{"use strict";sr.toString=function(t){switch(t){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return t<0?null:`OPTION_${t}`};sr.toCode=function(t){if(typeof t=="number")return t;if(!t)return-1;switch(t.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}let e=t.match(/_(\d+)$/);return e?parseInt(e[1],10):-1}});var Un=I(($d,kn)=>{var go=/^(\d{1,3}\.){3,3}\d{1,3}$/,fo=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i,ue={name:"v4",size:4,isFormat:t=>go.test(t),encode(t,e,r){r=~~r,e=e||new Uint8Array(r+4);let n=t.length,s=0;for(let i=0;i<n;){let o=t.charCodeAt(i++);o===46?(e[r++]=s,s=0):s=s*10+(o-48)}return e[r]=s,e},decode(t,e){return e=~~e,`${t[e++]}.${t[e++]}.${t[e++]}.${t[e]}`}},Ae={name:"v6",size:16,isFormat:t=>t.length>0&&fo.test(t),encode(t,e,r){r=~~r;let n=r+16,s=-1,i=0,o=0,a=!0,h=!1;e=e||new Uint8Array(r+16);for(let u=0;u<t.length;u++){let g=t.charCodeAt(u);g===58?(a?s!==-1?(r<n&&(e[r]=0),r<n-1&&(e[r+1]=0),r+=2):r<n&&(s=r):(h===!0?(r<n&&(e[r]=o),r++):(r<n&&(e[r]=i>>8),r<n-1&&(e[r+1]=i&255),r+=2),i=0,o=0),a=!0,h=!1):g===46?(r<n&&(e[r]=o),r++,o=0,i=0,a=!1,h=!0):(a=!1,g>=97?g-=87:g>=65?g-=55:(g-=48,o=o*10+g),i=(i<<4)+g)}if(a===!1)h===!0?(r<n&&(e[r]=o),r++):(r<n&&(e[r]=i>>8),r<n-1&&(e[r+1]=i&255),r+=2);else if(s===0)r<n&&(e[r]=0),r<n-1&&(e[r+1]=0),r+=2;else if(s!==-1){r+=2;for(let u=Math.min(r-1,n-1);u>=s+2;u--)e[u]=e[u-2];e[s]=0,e[s+1]=0,s=r}if(s!==r&&s!==-1)for(r>n-2&&(r=n-2);n>s;)e[--n]=r<n&&r>s?e[--r]:0;else for(;r<n;)e[r++]=0;return e},decode(t,e){e=~~e;let r="";for(let n=0;n<16;n+=2)n!==0&&(r+=":"),r+=(t[e+n]<<8|t[e+n+1]).toString(16);return r.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};function ir(t){if(ue.isFormat(t))return ue.size;if(Ae.isFormat(t))return Ae.size;throw Error(`Invalid ip address: ${t}`)}kn.exports=Object.freeze({name:"ip",sizeOf:ir,familyOf:t=>ir(t)===ue.size?1:2,v4:ue,v6:Ae,encode(t,e,r){r=~~r;let n=ir(t);return typeof e=="function"&&(e=e(r+n)),n===ue.size?ue.encode(t,e,r):Ae.encode(t,e,r)},decode(t,e,r){if(e=~~e,r=r||t.length-e,r===ue.size)return ue.decode(t,e,r);if(r===Ae.size)return Ae.decode(t,e,r);throw Error(`Invalid buffer size needs to be ${ue.size} for v4 or ${Ae.size} for v6.`)}})});var vn=I(E=>{"use strict";var x=require("buffer").Buffer,Ee=In(),_o=Tn(),wo=Rn(),Ot=Pn(),or=An(),ke=Un(),bo=0,Ln=32768,ar=32768,Eo=~ar,Nn=32768,xo=~Nn,f=E.name={};f.encode=function(t,e,r,{mail:n=!1}={}){e||(e=x.alloc(f.encodingLength(t))),r||(r=0);let s=r,i=t.replace(/^\.|\.$/gm,"");if(i.length){let o=[];if(n){let a="";i.split(".").forEach(h=>{h.endsWith("\\")?a+=(a.length?".":"")+h.slice(0,-1):o.length===0&&a.length?o.push(a+"."+h):o.push(h)})}else o=i.split(".");for(let a=0;a<o.length;a++){let h=e.write(o[a],r+1);e[r]=h,r+=h+1}}return e[r++]=0,f.encode.bytes=r-s,e};f.encode.bytes=0;f.decode=function(t,e,{mail:r=!1}={}){e||(e=0);let n=[],s=e,i=0,o=0,a=!1;for(;;){if(e>=t.length)throw new Error("Cannot decode name (buffer overflow)");let h=t[e++];if(o+=a?0:1,h===0)break;if(h&192)if((h&192)===192){if(e+1>t.length)throw new Error("Cannot decode name (buffer overflow)");let u=t.readUInt16BE(e-1)-49152;if(u>=s)throw new Error("Cannot decode name (bad pointer)");e=u,s=u,o+=a?0:1,a=!0}else throw new Error("Cannot decode name (bad label)");else{if(e+h>t.length)throw new Error("Cannot decode name (buffer overflow)");if(i+=h+1,i>254)throw new Error("Cannot decode name (name too long)");let u=t.toString("utf-8",e,e+h);r&&(u=u.replace(/\./g,"\\.")),n.push(u),e+=h,o+=a?0:h}}return f.decode.bytes=o,n.length===0?".":n.join(".")};f.decode.bytes=0;f.encodingLength=function(t){return t==="."||t===".."?1:x.byteLength(t.replace(/^\.|\.$/gm,""))+2};var T={};T.encode=function(t,e,r){e||(e=x.alloc(T.encodingLength(t))),r||(r=0);let n=e.write(t,r+1);return e[r]=n,T.encode.bytes=n+1,e};T.encode.bytes=0;T.decode=function(t,e){e||(e=0);let r=t[e],n=t.toString("utf-8",e+1,e+1+r);return T.decode.bytes=r+1,n};T.decode.bytes=0;T.encodingLength=function(t){return x.byteLength(t)+1};var ee={};ee.encode=function(t,e,r){e||(e=ee.encodingLength(t)),r||(r=0);let n=(t.flags||0)&32767,s=t.type==="response"?Ln:bo;return e.writeUInt16BE(t.id||0,r),e.writeUInt16BE(n|s,r+2),e.writeUInt16BE(t.questions.length,r+4),e.writeUInt16BE(t.answers.length,r+6),e.writeUInt16BE(t.authorities.length,r+8),e.writeUInt16BE(t.additionals.length,r+10),e};ee.encode.bytes=12;ee.decode=function(t,e){if(e||(e=0),t.length<12)throw new Error("Header must be 12 bytes");let r=t.readUInt16BE(e+2);return{id:t.readUInt16BE(e),type:r&Ln?"response":"query",flags:r&32767,flag_qr:(r>>15&1)===1,opcode:wo.toString(r>>11&15),flag_aa:(r>>10&1)===1,flag_tc:(r>>9&1)===1,flag_rd:(r>>8&1)===1,flag_ra:(r>>7&1)===1,flag_z:(r>>6&1)===1,flag_ad:(r>>5&1)===1,flag_cd:(r>>4&1)===1,rcode:_o.toString(r&15),questions:new Array(t.readUInt16BE(e+4)),answers:new Array(t.readUInt16BE(e+6)),authorities:new Array(t.readUInt16BE(e+8)),additionals:new Array(t.readUInt16BE(e+10))}};ee.decode.bytes=12;ee.encodingLength=function(){return 12};var le=E.unknown={};le.encode=function(t,e,r){return e||(e=x.alloc(le.encodingLength(t))),r||(r=0),e.writeUInt16BE(t.length,r),t.copy(e,r+2),le.encode.bytes=t.length+2,e};le.encode.bytes=0;le.decode=function(t,e){e||(e=0);let r=t.readUInt16BE(e),n=t.slice(e+2,e+2+r);return le.decode.bytes=r+2,n};le.decode.bytes=0;le.encodingLength=function(t){return t.length+2};var me=E.ns={};me.encode=function(t,e,r){return e||(e=x.alloc(me.encodingLength(t))),r||(r=0),f.encode(t,e,r+2),e.writeUInt16BE(f.encode.bytes,r),me.encode.bytes=f.encode.bytes+2,e};me.encode.bytes=0;me.decode=function(t,e){e||(e=0);let r=t.readUInt16BE(e),n=f.decode(t,e+2);return me.decode.bytes=r+2,n};me.decode.bytes=0;me.encodingLength=function(t){return f.encodingLength(t)+2};var pe=E.soa={};pe.encode=function(t,e,r){e||(e=x.alloc(pe.encodingLength(t))),r||(r=0);let n=r;return r+=2,f.encode(t.mname,e,r),r+=f.encode.bytes,f.encode(t.rname,e,r,{mail:!0}),r+=f.encode.bytes,e.writeUInt32BE(t.serial||0,r),r+=4,e.writeUInt32BE(t.refresh||0,r),r+=4,e.writeUInt32BE(t.retry||0,r),r+=4,e.writeUInt32BE(t.expire||0,r),r+=4,e.writeUInt32BE(t.minimum||0,r),r+=4,e.writeUInt16BE(r-n-2,n),pe.encode.bytes=r-n,e};pe.encode.bytes=0;pe.decode=function(t,e){e||(e=0);let r=e,n={};return e+=2,n.mname=f.decode(t,e),e+=f.decode.bytes,n.rname=f.decode(t,e,{mail:!0}),e+=f.decode.bytes,n.serial=t.readUInt32BE(e),e+=4,n.refresh=t.readUInt32BE(e),e+=4,n.retry=t.readUInt32BE(e),e+=4,n.expire=t.readUInt32BE(e),e+=4,n.minimum=t.readUInt32BE(e),e+=4,pe.decode.bytes=e-r,n};pe.decode.bytes=0;pe.encodingLength=function(t){return 22+f.encodingLength(t.mname)+f.encodingLength(t.rname)};var ye=E.txt={};ye.encode=function(t,e,r){Array.isArray(t)||(t=[t]);for(let s=0;s<t.length;s++)if(typeof t[s]=="string"&&(t[s]=x.from(t[s])),!x.isBuffer(t[s]))throw new Error("Must be a Buffer");e||(e=x.alloc(ye.encodingLength(t))),r||(r=0);let n=r;return r+=2,t.forEach(function(s){e[r++]=s.length,s.copy(e,r,0,s.length),r+=s.length}),e.writeUInt16BE(r-n-2,n),ye.encode.bytes=r-n,e};ye.encode.bytes=0;ye.decode=function(t,e){e||(e=0);let r=e,n=t.readUInt16BE(e);e+=2;let s=[];for(;n>0;){let i=t[e++];if(--n,n<i)throw new Error("Buffer overflow");s.push(t.slice(e,e+i)),e+=i,n-=i}return ye.decode.bytes=e-r,s};ye.decode.bytes=0;ye.encodingLength=function(t){Array.isArray(t)||(t=[t]);let e=2;return t.forEach(function(r){typeof r=="string"?e+=x.byteLength(r)+1:e+=r.length+1}),e};var ge=E.null={};ge.encode=function(t,e,r){e||(e=x.alloc(ge.encodingLength(t))),r||(r=0),typeof t=="string"&&(t=x.from(t)),t||(t=x.alloc(0));let n=r;r+=2;let s=t.length;return t.copy(e,r,0,s),r+=s,e.writeUInt16BE(r-n-2,n),ge.encode.bytes=r-n,e};ge.encode.bytes=0;ge.decode=function(t,e){e||(e=0);let r=e,n=t.readUInt16BE(e);e+=2;let s=t.slice(e,e+n);return e+=n,ge.decode.bytes=e-r,s};ge.decode.bytes=0;ge.encodingLength=function(t){return t?(x.isBuffer(t)?t.length:x.byteLength(t))+2:2};var fe=E.hinfo={};fe.encode=function(t,e,r){e||(e=x.alloc(fe.encodingLength(t))),r||(r=0);let n=r;return r+=2,T.encode(t.cpu,e,r),r+=T.encode.bytes,T.encode(t.os,e,r),r+=T.encode.bytes,e.writeUInt16BE(r-n-2,n),fe.encode.bytes=r-n,e};fe.encode.bytes=0;fe.decode=function(t,e){e||(e=0);let r=e,n={};return e+=2,n.cpu=T.decode(t,e),e+=T.decode.bytes,n.os=T.decode(t,e),e+=T.decode.bytes,fe.decode.bytes=e-r,n};fe.decode.bytes=0;fe.encodingLength=function(t){return T.encodingLength(t.cpu)+T.encodingLength(t.os)+2};var X=E.ptr={},So=E.cname=X,Oo=E.dname=X;X.encode=function(t,e,r){return e||(e=x.alloc(X.encodingLength(t))),r||(r=0),f.encode(t,e,r+2),e.writeUInt16BE(f.encode.bytes,r),X.encode.bytes=f.encode.bytes+2,e};X.encode.bytes=0;X.decode=function(t,e){e||(e=0);let r=f.decode(t,e+2);return X.decode.bytes=f.decode.bytes+2,r};X.decode.bytes=0;X.encodingLength=function(t){return f.encodingLength(t)+2};var _e=E.srv={};_e.encode=function(t,e,r){e||(e=x.alloc(_e.encodingLength(t))),r||(r=0),e.writeUInt16BE(t.priority||0,r+2),e.writeUInt16BE(t.weight||0,r+4),e.writeUInt16BE(t.port||0,r+6),f.encode(t.target,e,r+8);let n=f.encode.bytes+6;return e.writeUInt16BE(n,r),_e.encode.bytes=n+2,e};_e.encode.bytes=0;_e.decode=function(t,e){e||(e=0);let r=t.readUInt16BE(e),n={};return n.priority=t.readUInt16BE(e+2),n.weight=t.readUInt16BE(e+4),n.port=t.readUInt16BE(e+6),n.target=f.decode(t,e+8),_e.decode.bytes=r+2,n};_e.decode.bytes=0;_e.encodingLength=function(t){return 8+f.encodingLength(t.target)};var W=E.caa={};W.ISSUER_CRITICAL=128;W.encode=function(t,e,r){let n=W.encodingLength(t);return e||(e=x.alloc(W.encodingLength(t))),r||(r=0),t.issuerCritical&&(t.flags=W.ISSUER_CRITICAL),e.writeUInt16BE(n-2,r),r+=2,e.writeUInt8(t.flags||0,r),r+=1,T.encode(t.tag,e,r),r+=T.encode.bytes,e.write(t.value,r),r+=x.byteLength(t.value),W.encode.bytes=n,e};W.encode.bytes=0;W.decode=function(t,e){e||(e=0);let r=t.readUInt16BE(e);e+=2;let n=e,s={};return s.flags=t.readUInt8(e),e+=1,s.tag=T.decode(t,e),e+=T.decode.bytes,s.value=t.toString("utf-8",e,n+r),s.issuerCritical=!!(s.flags&W.ISSUER_CRITICAL),W.decode.bytes=r+2,s};W.decode.bytes=0;W.encodingLength=function(t){return T.encodingLength(t.tag)+T.encodingLength(t.value)+2};var Oe=E.mx={};Oe.encode=function(t,e,r){e||(e=x.alloc(Oe.encodingLength(t))),r||(r=0);let n=r;return r+=2,e.writeUInt16BE(t.preference||0,r),r+=2,f.encode(t.exchange,e,r),r+=f.encode.bytes,e.writeUInt16BE(r-n-2,n),Oe.encode.bytes=r-n,e};Oe.encode.bytes=0;Oe.decode=function(t,e){e||(e=0);let r=e,n={};return e+=2,n.preference=t.readUInt16BE(e),e+=2,n.exchange=f.decode(t,e),e+=f.decode.bytes,Oe.decode.bytes=e-r,n};Oe.encodingLength=function(t){return 4+f.encodingLength(t.exchange)};var we=E.a={};we.encode=function(t,e,r){return e||(e=x.alloc(we.encodingLength(t))),r||(r=0),e.writeUInt16BE(4,r),r+=2,ke.v4.encode(t,e,r),we.encode.bytes=6,e};we.encode.bytes=0;we.decode=function(t,e){e||(e=0),e+=2;let r=ke.v4.decode(t,e);return we.decode.bytes=6,r};we.decode.bytes=0;we.encodingLength=function(){return 6};var be=E.aaaa={};be.encode=function(t,e,r){return e||(e=x.alloc(be.encodingLength(t))),r||(r=0),e.writeUInt16BE(16,r),r+=2,ke.v6.encode(t,e,r),be.encode.bytes=18,e};be.encode.bytes=0;be.decode=function(t,e){e||(e=0),e+=2;let r=ke.v6.decode(t,e);return be.decode.bytes=18,r};be.decode.bytes=0;be.encodingLength=function(){return 18};var G=E.option={};G.encode=function(t,e,r){e||(e=x.alloc(G.encodingLength(t))),r||(r=0);let n=r,s=or.toCode(t.code);if(e.writeUInt16BE(s,r),r+=2,t.data)e.writeUInt16BE(t.data.length,r),r+=2,t.data.copy(e,r),r+=t.data.length;else switch(s){case 8:let i=t.sourcePrefixLength||0,o=t.family||ke.familyOf(t.ip),a=ke.encode(t.ip,x.alloc),h=Math.ceil(i/8);e.writeUInt16BE(h+4,r),r+=2,e.writeUInt16BE(o,r),r+=2,e.writeUInt8(i,r++),e.writeUInt8(t.scopePrefixLength||0,r++),a.copy(e,r,0,h),r+=h;break;case 11:t.timeout?(e.writeUInt16BE(2,r),r+=2,e.writeUInt16BE(t.timeout,r),r+=2):(e.writeUInt16BE(0,r),r+=2);break;case 12:let u=t.length||0;e.writeUInt16BE(u,r),r+=2,e.fill(0,r,r+u),r+=u;break;case 14:let g=t.tags.length*2;e.writeUInt16BE(g,r),r+=2;for(let S of t.tags)e.writeUInt16BE(S,r),r+=2;break;default:throw new Error(`Unknown roption code: ${t.code}`)}return G.encode.bytes=r-n,e};G.encode.bytes=0;G.decode=function(t,e){e||(e=0);let r={};r.code=t.readUInt16BE(e),r.type=or.toString(r.code),e+=2;let n=t.readUInt16BE(e);switch(e+=2,r.data=t.slice(e,e+n),r.code){case 8:r.family=t.readUInt16BE(e),e+=2,r.sourcePrefixLength=t.readUInt8(e++),r.scopePrefixLength=t.readUInt8(e++);let s=x.alloc(r.family===1?4:16);t.copy(s,0,e,e+n-4),r.ip=ke.decode(s);break;case 11:n>0&&(r.timeout=t.readUInt16BE(e),e+=2);break;case 14:r.tags=[];for(let i=0;i<n;i+=2)r.tags.push(t.readUInt16BE(e)),e+=2}return G.decode.bytes=n+4,r};G.decode.bytes=0;G.encodingLength=function(t){if(t.data)return t.data.length+4;switch(or.toCode(t.code)){case 8:let r=t.sourcePrefixLength||0;return Math.ceil(r/8)+8;case 11:return typeof t.timeout=="number"?6:4;case 12:return t.length+4;case 14:return 4+t.tags.length*2}throw new Error(`Unknown roption code: ${t.code}`)};var Y=E.opt={};Y.encode=function(t,e,r){e||(e=x.alloc(Y.encodingLength(t))),r||(r=0);let n=r,s=Be(t,G);return e.writeUInt16BE(s,r),r=Qe(t,G,e,r+2),Y.encode.bytes=r-n,e};Y.encode.bytes=0;Y.decode=function(t,e){e||(e=0);let r=e,n=[],s=t.readUInt16BE(e);e+=2;let i=0;for(;s>0;)n[i++]=G.decode(t,e),e+=G.decode.bytes,s-=G.decode.bytes;return Y.decode.bytes=e-r,n};Y.decode.bytes=0;Y.encodingLength=function(t){return 2+Be(t||[],G)};var z=E.dnskey={};z.PROTOCOL_DNSSEC=3;z.ZONE_KEY=128;z.SECURE_ENTRYPOINT=32768;z.encode=function(t,e,r){e||(e=x.alloc(z.encodingLength(t))),r||(r=0);let n=r,s=t.key;if(!x.isBuffer(s))throw new Error("Key must be a Buffer");return r+=2,e.writeUInt16BE(t.flags,r),r+=2,e.writeUInt8(z.PROTOCOL_DNSSEC,r),r+=1,e.writeUInt8(t.algorithm,r),r+=1,s.copy(e,r,0,s.length),r+=s.length,z.encode.bytes=r-n,e.writeUInt16BE(z.encode.bytes-2,n),e};z.encode.bytes=0;z.decode=function(t,e){e||(e=0);let r=e;var n={},s=t.readUInt16BE(e);if(e+=2,n.flags=t.readUInt16BE(e),e+=2,t.readUInt8(e)!==z.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return e+=1,n.algorithm=t.readUInt8(e),e+=1,n.key=t.slice(e,r+s+2),e+=n.key.length,z.decode.bytes=e-r,n};z.decode.bytes=0;z.encodingLength=function(t){return 6+x.byteLength(t.key)};var se=E.rrsig={};se.encode=function(t,e,r){e||(e=x.alloc(se.encodingLength(t))),r||(r=0);let n=r,s=t.signature;if(!x.isBuffer(s))throw new Error("Signature must be a Buffer");return r+=2,e.writeUInt16BE(Ee.toType(t.typeCovered),r),r+=2,e.writeUInt8(t.algorithm,r),r+=1,e.writeUInt8(t.labels,r),r+=1,e.writeUInt32BE(t.originalTTL,r),r+=4,e.writeUInt32BE(t.expiration,r),r+=4,e.writeUInt32BE(t.inception,r),r+=4,e.writeUInt16BE(t.keyTag,r),r+=2,f.encode(t.signersName,e,r),r+=f.encode.bytes,s.copy(e,r,0,s.length),r+=s.length,se.encode.bytes=r-n,e.writeUInt16BE(se.encode.bytes-2,n),e};se.encode.bytes=0;se.decode=function(t,e){e||(e=0);let r=e;var n={},s=t.readUInt16BE(e);return e+=2,n.typeCovered=Ee.toString(t.readUInt16BE(e)),e+=2,n.algorithm=t.readUInt8(e),e+=1,n.labels=t.readUInt8(e),e+=1,n.originalTTL=t.readUInt32BE(e),e+=4,n.expiration=t.readUInt32BE(e),e+=4,n.inception=t.readUInt32BE(e),e+=4,n.keyTag=t.readUInt16BE(e),e+=2,n.signersName=f.decode(t,e),e+=f.decode.bytes,n.signature=t.slice(e,r+s+2),e+=n.signature.length,se.decode.bytes=e-r,n};se.decode.bytes=0;se.encodingLength=function(t){return 20+f.encodingLength(t.signersName)+x.byteLength(t.signature)};var ie=E.rp={};ie.encode=function(t,e,r){e||(e=x.alloc(ie.encodingLength(t))),r||(r=0);let n=r;return r+=2,f.encode(t.mbox||".",e,r,{mail:!0}),r+=f.encode.bytes,f.encode(t.txt||".",e,r),r+=f.encode.bytes,ie.encode.bytes=r-n,e.writeUInt16BE(ie.encode.bytes-2,n),e};ie.encode.bytes=0;ie.decode=function(t,e){e||(e=0);let r=e,n={};return e+=2,n.mbox=f.decode(t,e,{mail:!0})||".",e+=f.decode.bytes,n.txt=f.decode(t,e)||".",e+=f.decode.bytes,ie.decode.bytes=e-r,n};ie.decode.bytes=0;ie.encodingLength=function(t){return 2+f.encodingLength(t.mbox||".")+f.encodingLength(t.txt||".")};var B={};B.encode=function(t,e,r){e||(e=x.alloc(B.encodingLength(t))),r||(r=0);let n=r;for(var s=[],i=0;i<t.length;i++){var o=Ee.toType(t[i]);s[o>>8]===void 0&&(s[o>>8]=[]),s[o>>8][o>>3&31]|=1<<7-(o&7)}for(i=0;i<s.length;i++)if(s[i]!==void 0){var a=x.from(s[i]);e.writeUInt8(i,r),r+=1,e.writeUInt8(a.length,r),r+=1,a.copy(e,r),r+=a.length}return B.encode.bytes=r-n,e};B.encode.bytes=0;B.decode=function(t,e,r){e||(e=0);let n=e;for(var s=[];e-n<r;){var i=t.readUInt8(e);e+=1;var o=t.readUInt8(e);e+=1;for(var a=0;a<o;a++)for(var h=t.readUInt8(e+a),u=0;u<8;u++)if(h&1<<7-u){var g=Ee.toString(i<<8|a<<3|u);s.push(g)}e+=o}return B.decode.bytes=e-n,s};B.decode.bytes=0;B.encodingLength=function(t){for(var e=[],r=0;r<t.length;r++){var n=Ee.toType(t[r]);e[n>>8]=Math.max(e[n>>8]||0,n&255)}var s=0;for(r=0;r<e.length;r++)e[r]!==void 0&&(s+=2+Math.ceil((e[r]+1)/8));return s};var oe=E.nsec={};oe.encode=function(t,e,r){e||(e=x.alloc(oe.encodingLength(t))),r||(r=0);let n=r;return r+=2,f.encode(t.nextDomain,e,r),r+=f.encode.bytes,B.encode(t.rrtypes,e,r),r+=B.encode.bytes,oe.encode.bytes=r-n,e.writeUInt16BE(oe.encode.bytes-2,n),e};oe.encode.bytes=0;oe.decode=function(t,e){e||(e=0);let r=e;var n={},s=t.readUInt16BE(e);return e+=2,n.nextDomain=f.decode(t,e),e+=f.decode.bytes,n.rrtypes=B.decode(t,e,s-(e-r)),e+=B.decode.bytes,oe.decode.bytes=e-r,n};oe.decode.bytes=0;oe.encodingLength=function(t){return 2+f.encodingLength(t.nextDomain)+B.encodingLength(t.rrtypes)};var ae=E.nsec3={};ae.encode=function(t,e,r){e||(e=x.alloc(ae.encodingLength(t))),r||(r=0);let n=r,s=t.salt;if(!x.isBuffer(s))throw new Error("salt must be a Buffer");let i=t.nextDomain;if(!x.isBuffer(i))throw new Error("nextDomain must be a Buffer");return r+=2,e.writeUInt8(t.algorithm,r),r+=1,e.writeUInt8(t.flags,r),r+=1,e.writeUInt16BE(t.iterations,r),r+=2,e.writeUInt8(s.length,r),r+=1,s.copy(e,r,0,s.length),r+=s.length,e.writeUInt8(i.length,r),r+=1,i.copy(e,r,0,i.length),r+=i.length,B.encode(t.rrtypes,e,r),r+=B.encode.bytes,ae.encode.bytes=r-n,e.writeUInt16BE(ae.encode.bytes-2,n),e};ae.encode.bytes=0;ae.decode=function(t,e){e||(e=0);let r=e;var n={},s=t.readUInt16BE(e);e+=2,n.algorithm=t.readUInt8(e),e+=1,n.flags=t.readUInt8(e),e+=1,n.iterations=t.readUInt16BE(e),e+=2;let i=t.readUInt8(e);e+=1,n.salt=t.slice(e,e+i),e+=i;let o=t.readUInt8(e);return e+=1,n.nextDomain=t.slice(e,e+o),e+=o,n.rrtypes=B.decode(t,e,s-(e-r)),e+=B.decode.bytes,ae.decode.bytes=e-r,n};ae.decode.bytes=0;ae.encodingLength=function(t){return 8+t.salt.length+t.nextDomain.length+B.encodingLength(t.rrtypes)};var ce=E.ds={};ce.encode=function(t,e,r){e||(e=x.alloc(ce.encodingLength(t))),r||(r=0);let n=r,s=t.digest;if(!x.isBuffer(s))throw new Error("Digest must be a Buffer");return r+=2,e.writeUInt16BE(t.keyTag,r),r+=2,e.writeUInt8(t.algorithm,r),r+=1,e.writeUInt8(t.digestType,r),r+=1,s.copy(e,r,0,s.length),r+=s.length,ce.encode.bytes=r-n,e.writeUInt16BE(ce.encode.bytes-2,n),e};ce.encode.bytes=0;ce.decode=function(t,e){e||(e=0);let r=e;var n={},s=t.readUInt16BE(e);return e+=2,n.keyTag=t.readUInt16BE(e),e+=2,n.algorithm=t.readUInt8(e),e+=1,n.digestType=t.readUInt8(e),e+=1,n.digest=t.slice(e,r+s+2),e+=n.digest.length,ce.decode.bytes=e-r,n};ce.decode.bytes=0;ce.encodingLength=function(t){return 6+x.byteLength(t.digest)};var K=E.sshfp={};K.getFingerprintLengthForHashType=function(e){switch(e){case 1:return 20;case 2:return 32}};K.encode=function(e,r,n){r||(r=x.alloc(K.encodingLength(e))),n||(n=0);let s=n;n+=2,r[n]=e.algorithm,n+=1,r[n]=e.hash,n+=1;let i=x.from(e.fingerprint.toUpperCase(),"hex");if(i.length!==K.getFingerprintLengthForHashType(e.hash))throw new Error("Invalid fingerprint length");return i.copy(r,n),n+=i.byteLength,K.encode.bytes=n-s,r.writeUInt16BE(K.encode.bytes-2,s),r};K.encode.bytes=0;K.decode=function(e,r){r||(r=0);let n=r,s={};r+=2,s.algorithm=e[r],r+=1,s.hash=e[r],r+=1;let i=K.getFingerprintLengthForHashType(s.hash);return s.fingerprint=e.slice(r,r+i).toString("hex").toUpperCase(),r+=i,K.decode.bytes=r-n,s};K.decode.bytes=0;K.encodingLength=function(t){return 4+x.from(t.fingerprint,"hex").byteLength};var de=E.naptr={};de.encode=function(t,e,r){e||(e=x.alloc(de.encodingLength(t))),r||(r=0);let n=r;return r+=2,e.writeUInt16BE(t.order||0,r),r+=2,e.writeUInt16BE(t.preference||0,r),r+=2,T.encode(t.flags,e,r),r+=T.encode.bytes,T.encode(t.services,e,r),r+=T.encode.bytes,T.encode(t.regexp,e,r),r+=T.encode.bytes,f.encode(t.replacement,e,r),r+=f.encode.bytes,de.encode.bytes=r-n,e.writeUInt16BE(de.encode.bytes-2,n),e};de.encode.bytes=0;de.decode=function(t,e){e||(e=0);let r=e,n={};return e+=2,n.order=t.readUInt16BE(e),e+=2,n.preference=t.readUInt16BE(e),e+=2,n.flags=T.decode(t,e),e+=T.decode.bytes,n.services=T.decode(t,e),e+=T.decode.bytes,n.regexp=T.decode(t,e),e+=T.decode.bytes,n.replacement=f.decode(t,e),e+=f.decode.bytes,de.decode.bytes=e-r,n};de.decode.bytes=0;de.encodingLength=function(t){return T.encodingLength(t.flags)+T.encodingLength(t.services)+T.encodingLength(t.regexp)+f.encodingLength(t.replacement)+6};var he=E.tlsa={};he.encode=function(t,e,r){e||(e=x.alloc(he.encodingLength(t))),r||(r=0);let n=r,s=t.certificate;if(!x.isBuffer(s))throw new Error("Certificate must be a Buffer");return r+=2,e.writeUInt8(t.usage,r),r+=1,e.writeUInt8(t.selector,r),r+=1,e.writeUInt8(t.matchingType,r),r+=1,s.copy(e,r,0,s.length),r+=s.length,he.encode.bytes=r-n,e.writeUInt16BE(he.encode.bytes-2,n),e};he.encode.bytes=0;he.decode=function(t,e){e||(e=0);let r=e,n={},s=t.readUInt16BE(e);return e+=2,n.usage=t.readUInt8(e),e+=1,n.selector=t.readUInt8(e),e+=1,n.matchingType=t.readUInt8(e),e+=1,n.certificate=t.slice(e,r+s+2),e+=n.certificate.length,he.decode.bytes=e-r,n};he.decode.bytes=0;he.encodingLength=function(t){return 5+x.byteLength(t.certificate)};var cr=E.record=function(t){switch(t.toUpperCase()){case"A":return we;case"PTR":return X;case"CNAME":return So;case"DNAME":return Oo;case"TXT":return ye;case"NULL":return ge;case"AAAA":return be;case"SRV":return _e;case"HINFO":return fe;case"CAA":return W;case"NS":return me;case"SOA":return pe;case"MX":return Oe;case"OPT":return Y;case"DNSKEY":return z;case"RRSIG":return se;case"RP":return ie;case"NSEC":return oe;case"NSEC3":return ae;case"SSHFP":return K;case"DS":return ce;case"NAPTR":return de;case"TLSA":return he}return le},j=E.answer={};j.encode=function(t,e,r){e||(e=x.alloc(j.encodingLength(t))),r||(r=0);let n=r;if(f.encode(t.name,e,r),r+=f.encode.bytes,e.writeUInt16BE(Ee.toType(t.type),r),t.type.toUpperCase()==="OPT"){if(t.name!==".")throw new Error("OPT name must be root.");e.writeUInt16BE(t.udpPayloadSize||4096,r+2),e.writeUInt8(t.extendedRcode||0,r+4),e.writeUInt8(t.ednsVersion||0,r+5),e.writeUInt16BE(t.flags||0,r+6),r+=8,Y.encode(t.options||[],e,r),r+=Y.encode.bytes}else{let s=Ot.toClass(t.class===void 0?"IN":t.class);t.flush&&(s|=ar),e.writeUInt16BE(s,r+2),e.writeUInt32BE(t.ttl||0,r+4),r+=8;let i=cr(t.type);i.encode(t.data,e,r),r+=i.encode.bytes}return j.encode.bytes=r-n,e};j.encode.bytes=0;j.decode=function(t,e){e||(e=0);let r={},n=e;if(r.name=f.decode(t,e),e+=f.decode.bytes,r.type=Ee.toString(t.readUInt16BE(e)),r.type==="OPT")r.udpPayloadSize=t.readUInt16BE(e+2),r.extendedRcode=t.readUInt8(e+4),r.ednsVersion=t.readUInt8(e+5),r.flags=t.readUInt16BE(e+6),r.flag_do=(r.flags>>15&1)===1,r.options=Y.decode(t,e+8),e+=8+Y.decode.bytes;else{let s=t.readUInt16BE(e+2);r.ttl=t.readUInt32BE(e+4),r.class=Ot.toString(s&Eo),r.flush=!!(s&ar);let i=cr(r.type);r.data=i.decode(t,e+8),e+=8+i.decode.bytes}return j.decode.bytes=e-n,r};j.decode.bytes=0;j.encodingLength=function(t){let e=t.data!==null&&t.data!==void 0?t.data:t.options;return f.encodingLength(t.name)+8+cr(t.type).encodingLength(e)};var Z=E.question={};Z.encode=function(t,e,r){e||(e=x.alloc(Z.encodingLength(t))),r||(r=0);let n=r;return f.encode(t.name,e,r),r+=f.encode.bytes,e.writeUInt16BE(Ee.toType(t.type),r),r+=2,e.writeUInt16BE(Ot.toClass(t.class===void 0?"IN":t.class),r),r+=2,Z.encode.bytes=r-n,t};Z.encode.bytes=0;Z.decode=function(t,e){e||(e=0);let r=e,n={};return n.name=f.decode(t,e),e+=f.decode.bytes,n.type=Ee.toString(t.readUInt16BE(e)),e+=2,n.class=Ot.toString(t.readUInt16BE(e)),e+=2,!!(n.class&Nn)&&(n.class&=xo),Z.decode.bytes=e-r,n};Z.decode.bytes=0;Z.encodingLength=function(t){return f.encodingLength(t.name)+4};E.AUTHORITATIVE_ANSWER=1024;E.TRUNCATED_RESPONSE=512;E.RECURSION_DESIRED=256;E.RECURSION_AVAILABLE=128;E.AUTHENTIC_DATA=32;E.CHECKING_DISABLED=16;E.DNSSEC_OK=32768;E.encode=function(t,e,r){let n=!e;n&&(e=x.alloc(E.encodingLength(t))),r||(r=0);let s=r;return t.questions||(t.questions=[]),t.answers||(t.answers=[]),t.authorities||(t.authorities=[]),t.additionals||(t.additionals=[]),ee.encode(t,e,r),r+=ee.encode.bytes,r=Qe(t.questions,Z,e,r),r=Qe(t.answers,j,e,r),r=Qe(t.authorities,j,e,r),r=Qe(t.additionals,j,e,r),E.encode.bytes=r-s,n&&E.encode.bytes!==e.length?e.slice(0,E.encode.bytes):e};E.encode.bytes=0;E.decode=function(t,e){e||(e=0);let r=e,n=ee.decode(t,e);return e+=ee.decode.bytes,e=St(n.questions,Z,t,e),e=St(n.answers,j,t,e),e=St(n.authorities,j,t,e),e=St(n.additionals,j,t,e),E.decode.bytes=e-r,n};E.decode.bytes=0;E.encodingLength=function(t){return ee.encodingLength(t)+Be(t.questions||[],Z)+Be(t.answers||[],j)+Be(t.authorities||[],j)+Be(t.additionals||[],j)};E.streamEncode=function(t){let e=E.encode(t),r=x.alloc(2);r.writeUInt16BE(e.byteLength);let n=x.concat([r,e]);return E.streamEncode.bytes=n.byteLength,n};E.streamEncode.bytes=0;E.streamDecode=function(t){let e=t.readUInt16BE(0);if(t.byteLength<e+2)return null;let r=E.decode(t.slice(2));return E.streamDecode.bytes=E.decode.bytes,r};E.streamDecode.bytes=0;function Be(t,e){let r=0;for(let n=0;n<t.length;n++)r+=e.encodingLength(t[n]);return r}function Qe(t,e,r,n){for(let s=0;s<t.length;s++)e.encode(t[s],r,n),n+=e.encode.bytes;return n}function St(t,e,r,n){for(let s=0;s<t.length;s++)t[s]=e.decode(r,n),n+=e.decode.bytes;return n}});var Bn=I((Fd,Hn)=>{"use strict";var Co=require("dgram"),Io=require("util"),te=vn(),Dn=require("events");Hn.exports=A;function A(t){if(!(this instanceof A))return new A(t);t||(t={}),Dn.EventEmitter.call(this);let e=this;this.retries=t.retries!==void 0?t.retries:5,this.timeout=t.timeout||7500,this.timeoutChecks=t.timeoutChecks||this.timeout/10,this.destroyed=!1,this.inflight=0,this.maxQueries=t.maxQueries||1e4,this.maxRedirects=t.maxRedirects||0,this.socket=t.socket||Co.createSocket("udp4"),this._id=Math.ceil(Math.random()*this.maxQueries),this._queries=new Array(this.maxQueries).fill(null),this._interval=null,this.socket.on("error",r),this.socket.on("message",n),Ro(this.socket)?i():this.socket.on("listening",i),this.socket.on("close",o);function r(a){a.code==="EACCES"||a.code==="EADDRINUSE"?e.emit("error",a):e.emit("warning",a)}function n(a,h){e._onmessage(a,h)}function s(){e._ontimeoutCheck()}function i(){e._interval=setInterval(s,e.timeoutChecks),e.emit("listening")}function o(){e.emit("close")}}Io.inherits(A,Dn.EventEmitter);A.RECURSION_DESIRED=A.prototype.RECURSION_DESIRED=te.RECURSION_DESIRED;A.RECURSION_AVAILABLE=A.prototype.RECURSION_AVAILABLE=te.RECURSION_AVAILABLE;A.TRUNCATED_RESPONSE=A.prototype.TRUNCATED_RESPONSE=te.TRUNCATED_RESPONSE;A.AUTHORITATIVE_ANSWER=A.prototype.AUTHORITATIVE_ANSWER=te.AUTHORITATIVE_ANSWER;A.AUTHENTIC_DATA=A.prototype.AUTHENTIC_DATA=te.AUTHENTIC_DATA;A.CHECKING_DISABLED=A.prototype.CHECKING_DISABLED=te.CHECKING_DISABLED;A.prototype.address=function(){return this.socket.address()};A.prototype.bind=function(...t){let e=t.length>0&&t[t.length-1];typeof e=="function"?(this.once("listening",e),this.socket.bind(...t.slice(0,-1))):this.socket.bind(...t)};A.prototype.destroy=function(t){if(t&&this.once("close",t),!this.destroyed){this.destroyed=!0,clearInterval(this._interval),this.socket.close();for(let e=0;e<this.maxQueries;e++){let r=this._queries[e];r&&(r.callback(new Error("Socket destroyed")),this._queries[e]=null)}this.inflight=0}};A.prototype._ontimeoutCheck=function(){let t=Date.now();for(let e=0;e<this.maxQueries;e++){let r=this._queries[e];if(!(!r||t-r.firstTry<(r.tries+1)*this.timeout)){if(r.tries>this.retries){this._queries[e]=null,this.inflight--,this.emit("timeout",r.query,r.port,r.host),r.callback(new Error("Query timed out"));continue}r.tries++,this.socket.send(r.buffer,0,r.buffer.length,r.port,Array.isArray(r.host)?r.host[Math.floor(r.host.length*Math.random())]:r.host||"127.0.0.1")}}};A.prototype._shouldRedirect=function(t,e){if(this.maxRedirects<=0||!t||t.query.questions.length!==1||e.answers.filter(s=>s.type==="A").length>0||t.redirects>this.maxRedirects)return!1;let r=e.answers.filter(s=>s.type==="CNAME");if(r.length===0)return!1;let n=this._getNextEmptyId();return n===-1?(t.callback(new Error("Query array is full!")),!0):(t.query={id:n+1,flags:te.RECURSION_DESIRED,questions:[{type:"A",name:r[0].data}]},t.redirects++,t.firstTry=Date.now(),t.tries=0,t.buffer=te.encode(t.query),this._queries[n]=t,this.socket.send(t.buffer,0,t.buffer.length,t.port,Array.isArray(t.host)?t.host[Math.floor(t.host.length*Math.random())]:t.host||"127.0.0.1"),!0)};A.prototype._onmessage=function(t,e){let r;try{r=te.decode(t)}catch(n){this.emit("warning",n);return}if(r.type==="response"&&r.id){let n=this._queries[r.id-1];n&&(this._queries[r.id-1]=null,this.inflight--,this._shouldRedirect(n,r)||n.callback(null,r))}this.emit(r.type,r,e.port,e.address)};A.prototype.unref=function(){this.socket.unref()};A.prototype.ref=function(){this.socket.ref()};A.prototype.response=function(t,e,r,n){if(this.destroyed)return;e.type="response",e.id=t.id;let s=te.encode(e);this.socket.send(s,0,s.length,r,n)};A.prototype.cancel=function(t){let e=this._queries[t];e&&(this._queries[t]=null,this.inflight--,e.callback(new Error("Query cancelled")))};A.prototype.setRetries=function(t,e){let r=this._queries[t];r&&(r.firstTry=r.firstTry-this.timeout*(e-r.retries),r.retries=this.retries-e)};A.prototype._getNextEmptyId=function(){let t=-1;for(let e=this.maxQueries;e>0;e--){let r=(this._id+e)%this.maxQueries;if(this._queries[r]===null){t=r,this._id=(r+1)%this.maxQueries;break}}return t};A.prototype.query=function(t,e,r,n){if(this.destroyed)return n(new Error("Socket destroyed")),0;this.inflight++,t.type="query",t.flags=typeof t.flags=="number"?t.flags:A.RECURSION_DESIRED;let s=this._getNextEmptyId();if(s===-1)return n(new Error("Query array is full!")),0;t.id=s+1;let i=te.encode(t);return this._queries[s]={callback:n||To,redirects:0,firstTry:Date.now(),query:t,tries:0,buffer:i,port:e,host:r},this.socket.send(i,0,i.length,e,Array.isArray(r)?r[Math.floor(r.length*Math.random())]:r||"127.0.0.1"),s};function To(){}function Ro(t){try{return t.address().port!==0}catch{return!1}}});var zn=I((ur,lr)=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});function zo(t){return t.encrypted}var hr=(t,e)=>{let r;typeof e=="function"?r={connect:e}:r=e;let n=typeof r.connect=="function",s=typeof r.secureConnect=="function",i=typeof r.close=="function",o=()=>{n&&r.connect(),zo(t)&&s&&(t.authorized?r.secureConnect():t.authorizationError||t.once("secureConnect",r.secureConnect)),i&&t.once("close",r.close)};t.writable&&!t.connecting?o():t.connecting?t.once("connect",o):t.destroyed&&i&&r.close(t._hadError)};ur.default=hr;lr.exports=hr;lr.exports.default=hr});var Kn=I((Qd,Wn)=>{"use strict";var{PassThrough:Yo}=require("stream");Wn.exports=t=>{t={...t};let{array:e}=t,{encoding:r}=t,n=r==="buffer",s=!1;e?s=!(r||n):r=r||"utf8",n&&(r=null);let i=new Yo({objectMode:s});r&&i.setEncoding(r);let o=0,a=[];return i.on("data",h=>{a.push(h),s?o=a.length:o+=h.length}),i.getBufferedValue=()=>e?a:n?Buffer.concat(a,o):a.join(""),i.getBufferedLength=()=>o,i}});var gr=I((Jd,et)=>{"use strict";var{constants:Qo}=require("buffer"),Jo=require("stream"),{promisify:Xo}=require("util"),Zo=Kn(),ea=Xo(Jo.pipeline),At=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function yr(t,e){if(!t)throw new Error("Expected a stream");e={maxBuffer:1/0,...e};let{maxBuffer:r}=e,n=Zo(e);return await new Promise((s,i)=>{let o=a=>{a&&n.getBufferedLength()<=Qo.MAX_LENGTH&&(a.bufferedData=n.getBufferedValue()),i(a)};(async()=>{try{await ea(t,n),s()}catch(a){o(a)}})(),n.on("data",()=>{n.getBufferedLength()>r&&o(new At)})}),n.getBufferedValue()}et.exports=yr;et.exports.buffer=(t,e)=>yr(t,{...e,encoding:"buffer"});et.exports.array=(t,e)=>yr(t,{...e,array:!0});et.exports.MaxBufferError=At});var Qn=I((Zd,Yn)=>{"use strict";var ta=new Set([200,203,204,206,300,301,308,404,405,410,414,501]),ra=new Set([200,203,204,300,301,302,303,307,308,404,405,410,414,501]),na=new Set([500,502,503,504]),sa={date:!0,connection:!0,"keep-alive":!0,"proxy-authenticate":!0,"proxy-authorization":!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0},ia={"content-length":!0,"content-encoding":!0,"transfer-encoding":!0,"content-range":!0};function Ue(t){let e=parseInt(t,10);return isFinite(e)?e:0}function oa(t){return t?na.has(t.status):!0}function fr(t){let e={};if(!t)return e;let r=t.trim().split(/,/);for(let n of r){let[s,i]=n.split(/=/,2);e[s.trim()]=i===void 0?!0:i.trim().replace(/^"|"$/g,"")}return e}function aa(t){let e=[];for(let r in t){let n=t[r];e.push(n===!0?r:r+"="+n)}if(e.length)return e.join(", ")}Yn.exports=class{constructor(e,r,{shared:n,cacheHeuristic:s,immutableMinTimeToLive:i,ignoreCargoCult:o,_fromObject:a}={}){if(a){this._fromObject(a);return}if(!r||!r.headers)throw Error("Response headers missing");this._assertRequestHasHeaders(e),this._responseTime=this.now(),this._isShared=n!==!1,this._cacheHeuristic=s!==void 0?s:.1,this._immutableMinTtl=i!==void 0?i:24*3600*1e3,this._status="status"in r?r.status:200,this._resHeaders=r.headers,this._rescc=fr(r.headers["cache-control"]),this._method="method"in e?e.method:"GET",this._url=e.url,this._host=e.headers.host,this._noAuthorization=!e.headers.authorization,this._reqHeaders=r.headers.vary?e.headers:null,this._reqcc=fr(e.headers["cache-control"]),o&&"pre-check"in this._rescc&&"post-check"in this._rescc&&(delete this._rescc["pre-check"],delete this._rescc["post-check"],delete this._rescc["no-cache"],delete this._rescc["no-store"],delete this._rescc["must-revalidate"],this._resHeaders=Object.assign({},this._resHeaders,{"cache-control":aa(this._rescc)}),delete this._resHeaders.expires,delete this._resHeaders.pragma),r.headers["cache-control"]==null&&/no-cache/.test(r.headers.pragma)&&(this._rescc["no-cache"]=!0)}now(){return Date.now()}storable(){return!!(!this._reqcc["no-store"]&&(this._method==="GET"||this._method==="HEAD"||this._method==="POST"&&this._hasExplicitExpiration())&&ra.has(this._status)&&!this._rescc["no-store"]&&(!this._isShared||!this._rescc.private)&&(!this._isShared||this._noAuthorization||this._allowsStoringAuthenticated())&&(this._resHeaders.expires||this._rescc["max-age"]||this._isShared&&this._rescc["s-maxage"]||this._rescc.public||ta.has(this._status)))}_hasExplicitExpiration(){return this._isShared&&this._rescc["s-maxage"]||this._rescc["max-age"]||this._resHeaders.expires}_assertRequestHasHeaders(e){if(!e||!e.headers)throw Error("Request headers missing")}satisfiesWithoutRevalidation(e){this._assertRequestHasHeaders(e);let r=fr(e.headers["cache-control"]);return r["no-cache"]||/no-cache/.test(e.headers.pragma)||r["max-age"]&&this.age()>r["max-age"]||r["min-fresh"]&&this.timeToLive()<1e3*r["min-fresh"]||this.stale()&&!(r["max-stale"]&&!this._rescc["must-revalidate"]&&(r["max-stale"]===!0||r["max-stale"]>this.age()-this.maxAge()))?!1:this._requestMatches(e,!1)}_requestMatches(e,r){return(!this._url||this._url===e.url)&&this._host===e.headers.host&&(!e.method||this._method===e.method||r&&e.method==="HEAD")&&this._varyMatches(e)}_allowsStoringAuthenticated(){return this._rescc["must-revalidate"]||this._rescc.public||this._rescc["s-maxage"]}_varyMatches(e){if(!this._resHeaders.vary)return!0;if(this._resHeaders.vary==="*")return!1;let r=this._resHeaders.vary.trim().toLowerCase().split(/\s*,\s*/);for(let n of r)if(e.headers[n]!==this._reqHeaders[n])return!1;return!0}_copyWithoutHopByHopHeaders(e){let r={};for(let n in e)sa[n]||(r[n]=e[n]);if(e.connection){let n=e.connection.trim().split(/\s*,\s*/);for(let s of n)delete r[s]}if(r.warning){let n=r.warning.split(/,/).filter(s=>!/^\s*1[0-9][0-9]/.test(s));n.length?r.warning=n.join(",").trim():delete r.warning}return r}responseHeaders(){let e=this._copyWithoutHopByHopHeaders(this._resHeaders),r=this.age();return r>3600*24&&!this._hasExplicitExpiration()&&this.maxAge()>3600*24&&(e.warning=(e.warning?`${e.warning}, `:"")+'113 - "rfc7234 5.5.4"'),e.age=`${Math.round(r)}`,e.date=new Date(this.now()).toUTCString(),e}date(){let e=Date.parse(this._resHeaders.date);return isFinite(e)?e:this._responseTime}age(){let e=this._ageValue(),r=(this.now()-this._responseTime)/1e3;return e+r}_ageValue(){return Ue(this._resHeaders.age)}maxAge(){if(!this.storable()||this._rescc["no-cache"]||this._isShared&&this._resHeaders["set-cookie"]&&!this._rescc.public&&!this._rescc.immutable||this._resHeaders.vary==="*")return 0;if(this._isShared){if(this._rescc["proxy-revalidate"])return 0;if(this._rescc["s-maxage"])return Ue(this._rescc["s-maxage"])}if(this._rescc["max-age"])return Ue(this._rescc["max-age"]);let e=this._rescc.immutable?this._immutableMinTtl:0,r=this.date();if(this._resHeaders.expires){let n=Date.parse(this._resHeaders.expires);return Number.isNaN(n)||n<r?0:Math.max(e,(n-r)/1e3)}if(this._resHeaders["last-modified"]){let n=Date.parse(this._resHeaders["last-modified"]);if(isFinite(n)&&r>n)return Math.max(e,(r-n)/1e3*this._cacheHeuristic)}return e}timeToLive(){let e=this.maxAge()-this.age(),r=e+Ue(this._rescc["stale-if-error"]),n=e+Ue(this._rescc["stale-while-revalidate"]);return Math.max(0,e,r,n)*1e3}stale(){return this.maxAge()<=this.age()}_useStaleIfError(){return this.maxAge()+Ue(this._rescc["stale-if-error"])>this.age()}useStaleWhileRevalidate(){return this.maxAge()+Ue(this._rescc["stale-while-revalidate"])>this.age()}static fromObject(e){return new this(void 0,void 0,{_fromObject:e})}_fromObject(e){if(this._responseTime)throw Error("Reinitialized");if(!e||e.v!==1)throw Error("Invalid serialization");this._responseTime=e.t,this._isShared=e.sh,this._cacheHeuristic=e.ch,this._immutableMinTtl=e.imm!==void 0?e.imm:24*3600*1e3,this._status=e.st,this._resHeaders=e.resh,this._rescc=e.rescc,this._method=e.m,this._url=e.u,this._host=e.h,this._noAuthorization=e.a,this._reqHeaders=e.reqh,this._reqcc=e.reqcc}toObject(){return{v:1,t:this._responseTime,sh:this._isShared,ch:this._cacheHeuristic,imm:this._immutableMinTtl,st:this._status,resh:this._resHeaders,rescc:this._rescc,m:this._method,u:this._url,h:this._host,a:this._noAuthorization,reqh:this._reqHeaders,reqcc:this._reqcc}}revalidationHeaders(e){this._assertRequestHasHeaders(e);let r=this._copyWithoutHopByHopHeaders(e.headers);if(delete r["if-range"],!this._requestMatches(e,!0)||!this.storable())return delete r["if-none-match"],delete r["if-modified-since"],r;if(this._resHeaders.etag&&(r["if-none-match"]=r["if-none-match"]?`${r["if-none-match"]}, ${this._resHeaders.etag}`:this._resHeaders.etag),r["accept-ranges"]||r["if-match"]||r["if-unmodified-since"]||this._method&&this._method!="GET"){if(delete r["if-modified-since"],r["if-none-match"]){let s=r["if-none-match"].split(/,/).filter(i=>!/^\s*W\//.test(i));s.length?r["if-none-match"]=s.join(",").trim():delete r["if-none-match"]}}else this._resHeaders["last-modified"]&&!r["if-modified-since"]&&(r["if-modified-since"]=this._resHeaders["last-modified"]);return r}revalidatedPolicy(e,r){if(this._assertRequestHasHeaders(e),this._useStaleIfError()&&oa(r))return{modified:!1,matches:!1,policy:this};if(!r||!r.headers)throw Error("Response headers missing");let n=!1;if(r.status!==void 0&&r.status!=304?n=!1:r.headers.etag&&!/^\s*W\//.test(r.headers.etag)?n=this._resHeaders.etag&&this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag:this._resHeaders.etag&&r.headers.etag?n=this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag.replace(/^\s*W\//,""):this._resHeaders["last-modified"]?n=this._resHeaders["last-modified"]===r.headers["last-modified"]:!this._resHeaders.etag&&!this._resHeaders["last-modified"]&&!r.headers.etag&&!r.headers["last-modified"]&&(n=!0),!n)return{policy:new this.constructor(e,r),modified:r.status!=304,matches:!1};let s={};for(let o in this._resHeaders)s[o]=o in r.headers&&!ia[o]?r.headers[o]:this._resHeaders[o];let i=Object.assign({},r,{status:this._status,method:this._method,headers:s});return{policy:new this.constructor(e,i,{shared:this._isShared,cacheHeuristic:this._cacheHeuristic,immutableMinTimeToLive:this._immutableMinTtl}),modified:!1,matches:!0}}}});var Xn=I(_r=>{_r.stringify=function t(e){if(typeof e>"u")return e;if(e&&Buffer.isBuffer(e))return JSON.stringify(":base64:"+e.toString("base64"));if(e&&e.toJSON&&(e=e.toJSON()),e&&typeof e=="object"){var r="",n=Array.isArray(e);r=n?"[":"{";var s=!0;for(var i in e){var o=typeof e[i]=="function"||!n&&typeof e[i]>"u";Object.hasOwnProperty.call(e,i)&&!o&&(s||(r+=","),s=!1,n?e[i]==null?r+="null":r+=t(e[i]):e[i]!==void 0&&(r+=t(i)+":"+t(e[i])))}return r+=n?"]":"}",r}else return typeof e=="string"?JSON.stringify(/^:/.test(e)?":"+e:e):typeof e>"u"?"null":JSON.stringify(e)};_r.parse=function(t){return JSON.parse(t,function(e,r){return typeof r=="string"?/^:base64:/.test(r)?Buffer.from(r.substring(8),"base64"):/^:/.test(r)?r.substring(1):r:r})}});var rs=I((sh,ts)=>{"use strict";var ca=require("events"),Zn=Xn(),da=t=>{let e={redis:"@keyv/redis",rediss:"@keyv/redis",mongodb:"@keyv/mongo",mongo:"@keyv/mongo",sqlite:"@keyv/sqlite",postgresql:"@keyv/postgres",postgres:"@keyv/postgres",mysql:"@keyv/mysql",etcd:"@keyv/etcd",offline:"@keyv/offline",tiered:"@keyv/tiered"};if(t.adapter||t.uri){let r=t.adapter||/^[^:+]*/.exec(t.uri)[0];return new(require(e[r]))(t)}return new Map},es=["sqlite","postgres","mysql","mongo","redis","tiered"],wr=class extends ca{constructor(e,{emitErrors:r=!0,...n}={}){if(super(),this.opts={namespace:"keyv",serialize:Zn.stringify,deserialize:Zn.parse,...typeof e=="string"?{uri:e}:e,...n},!this.opts.store){let i={...this.opts};this.opts.store=da(i)}if(this.opts.compression){let i=this.opts.compression;this.opts.serialize=i.serialize.bind(i),this.opts.deserialize=i.deserialize.bind(i)}typeof this.opts.store.on=="function"&&r&&this.opts.store.on("error",i=>this.emit("error",i)),this.opts.store.namespace=this.opts.namespace;let s=i=>async function*(){for await(let[o,a]of typeof i=="function"?i(this.opts.store.namespace):i){let h=await this.opts.deserialize(a);if(!(this.opts.store.namespace&&!o.includes(this.opts.store.namespace))){if(typeof h.expires=="number"&&Date.now()>h.expires){this.delete(o);continue}yield[this._getKeyUnprefix(o),h.value]}}};typeof this.opts.store[Symbol.iterator]=="function"&&this.opts.store instanceof Map?this.iterator=s(this.opts.store):typeof this.opts.store.iterator=="function"&&this.opts.store.opts&&this._checkIterableAdaptar()&&(this.iterator=s(this.opts.store.iterator.bind(this.opts.store)))}_checkIterableAdaptar(){return es.includes(this.opts.store.opts.dialect)||es.findIndex(e=>this.opts.store.opts.url.includes(e))>=0}_getKeyPrefix(e){return`${this.opts.namespace}:${e}`}_getKeyPrefixArray(e){return e.map(r=>`${this.opts.namespace}:${r}`)}_getKeyUnprefix(e){return e.split(":").splice(1).join(":")}get(e,r){let{store:n}=this.opts,s=Array.isArray(e),i=s?this._getKeyPrefixArray(e):this._getKeyPrefix(e);if(s&&n.getMany===void 0){let o=[];for(let a of i)o.push(Promise.resolve().then(()=>n.get(a)).then(h=>typeof h=="string"?this.opts.deserialize(h):this.opts.compression?this.opts.deserialize(h):h).then(h=>{if(h!=null)return typeof h.expires=="number"&&Date.now()>h.expires?this.delete(a).then(()=>{}):r&&r.raw?h:h.value}));return Promise.allSettled(o).then(a=>{let h=[];for(let u of a)h.push(u.value);return h})}return Promise.resolve().then(()=>s?n.getMany(i):n.get(i)).then(o=>typeof o=="string"?this.opts.deserialize(o):this.opts.compression?this.opts.deserialize(o):o).then(o=>{if(o!=null)return s?o.map((a,h)=>{if(typeof a=="string"&&(a=this.opts.deserialize(a)),a!=null){if(typeof a.expires=="number"&&Date.now()>a.expires){this.delete(e[h]).then(()=>{});return}return r&&r.raw?a:a.value}}):typeof o.expires=="number"&&Date.now()>o.expires?this.delete(e).then(()=>{}):r&&r.raw?o:o.value})}set(e,r,n){let s=this._getKeyPrefix(e);typeof n>"u"&&(n=this.opts.ttl),n===0&&(n=void 0);let{store:i}=this.opts;return Promise.resolve().then(()=>{let o=typeof n=="number"?Date.now()+n:null;return typeof r=="symbol"&&this.emit("error","symbol cannot be serialized"),r={value:r,expires:o},this.opts.serialize(r)}).then(o=>i.set(s,o,n)).then(()=>!0)}delete(e){let{store:r}=this.opts;if(Array.isArray(e)){let s=this._getKeyPrefixArray(e);if(r.deleteMany===void 0){let i=[];for(let o of s)i.push(r.delete(o));return Promise.allSettled(i).then(o=>o.every(a=>a.value===!0))}return Promise.resolve().then(()=>r.deleteMany(s))}let n=this._getKeyPrefix(e);return Promise.resolve().then(()=>r.delete(n))}clear(){let{store:e}=this.opts;return Promise.resolve().then(()=>e.clear())}has(e){let r=this._getKeyPrefix(e),{store:n}=this.opts;return Promise.resolve().then(async()=>typeof n.has=="function"?n.has(r):await n.get(r)!==void 0)}disconnect(){let{store:e}=this.opts;if(typeof e.disconnect=="function")return e.disconnect()}};ts.exports=wr});var ds=I((mh,cs)=>{"use strict";var pa=["aborted","complete","headers","httpVersion","httpVersionMinor","httpVersionMajor","method","rawHeaders","rawTrailers","setTimeout","socket","statusCode","statusMessage","trailers","url"];cs.exports=(t,e)=>{if(e._readableState.autoDestroy)throw new Error("The second stream must have the `autoDestroy` option set to `false`");let r=new Set(Object.keys(t).concat(pa)),n={};for(let s of r)s in e||(n[s]={get(){let i=t[s];return typeof i=="function"?i.bind(t):i},set(i){t[s]=i},enumerable:!0,configurable:!1});return Object.defineProperties(e,n),t.once("aborted",()=>{e.destroy(),e.emit("aborted")}),t.once("close",()=>{t.complete&&e.readable?e.once("end",()=>{e.emit("close")}):e.emit("close")}),e}});var us=I((ph,hs)=>{"use strict";var{Transform:ya,PassThrough:ga}=require("stream"),Sr=require("zlib"),fa=ds();hs.exports=t=>{let e=(t.headers["content-encoding"]||"").toLowerCase();if(!["gzip","deflate","br"].includes(e))return t;let r=e==="br";if(r&&typeof Sr.createBrotliDecompress!="function")return t.destroy(new Error("Brotli is not supported on Node.js < 12")),t;let n=!0,s=new ya({transform(a,h,u){n=!1,u(null,a)},flush(a){a()}}),i=new ga({autoDestroy:!1,destroy(a,h){t.destroy(),h(a)}}),o=r?Sr.createBrotliDecompress():Sr.createUnzip();return o.once("error",a=>{if(n&&!t.readable){i.end();return}i.destroy(a)}),fa(t,i),t.pipe(s).pipe(o).pipe(i),i}});var Nr=I((Qh,Ps)=>{"use strict";var Lr=class{constructor(e={}){if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(e,r){if(this.cache.set(e,r),this._size++,this._size>=this.maxSize){if(this._size=0,typeof this.onEviction=="function")for(let[n,s]of this.oldCache.entries())this.onEviction(n,s);this.oldCache=this.cache,this.cache=new Map}}get(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){let r=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,r),r}}set(e,r){return this.cache.has(e)?this.cache.set(e,r):this._set(e,r),this}has(e){return this.cache.has(e)||this.oldCache.has(e)}peek(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e))return this.oldCache.get(e)}delete(e){let r=this.cache.delete(e);return r&&this._size--,this.oldCache.delete(e)||r}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(let[e]of this)yield e}*values(){for(let[,e]of this)yield e}*[Symbol.iterator](){for(let e of this.cache)yield e;for(let e of this.oldCache){let[r]=e;this.cache.has(r)||(yield e)}}get size(){let e=0;for(let r of this.oldCache.keys())this.cache.has(r)||e++;return Math.min(this._size+e,this.maxSize)}};Ps.exports=Lr});var vr=I((Jh,As)=>{"use strict";As.exports=t=>{if(t.listenerCount("error")!==0)return t;t.__destroy=t._destroy,t._destroy=(...r)=>{let n=r.pop();t.__destroy(...r,async s=>{await Promise.resolve(),n(s)})};let e=r=>{Promise.resolve().then(()=>{t.emit("error",r)})};return t.once("error",e),Promise.resolve().then(()=>{t.off("error",e)}),t}});var Ne=I((Xh,Ds)=>{"use strict";var{URL:ks}=require("url"),Aa=require("events"),ka=require("tls"),Ua=require("http2"),La=Nr(),Na=vr(),F=Symbol("currentStreamCount"),Us=Symbol("request"),M=Symbol("cachedOriginSet"),Re=Symbol("gracefullyClosing"),jt=Symbol("length"),Ls=["createConnection","maxDeflateDynamicTableSize","maxSettings","maxSessionMemory","maxHeaderListPairs","maxOutstandingPings","maxReservedRemoteStreams","maxSendHeaderBlockLength","paddingStrategy","peerMaxConcurrentStreams","settings","family","localAddress","rejectUnauthorized","pskCallback","minDHSize","path","socket","ca","cert","sigalgs","ciphers","clientCertEngine","crl","dhparam","ecdhCurve","honorCipherOrder","key","privateKeyEngine","privateKeyIdentifier","maxVersion","minVersion","pfx","secureOptions","secureProtocol","sessionIdContext","ticketKeys"],va=(t,e,r)=>{let n=0,s=t.length;for(;n<s;){let i=n+s>>>1;r(t[i],e)?n=i+1:s=i}return n},Da=(t,e)=>t.remoteSettings.maxConcurrentStreams>e.remoteSettings.maxConcurrentStreams,Dr=(t,e)=>{for(let r=0;r<t.length;r++){let n=t[r];n[M].length>0&&n[M].length<e[M].length&&n[M].every(s=>e[M].includes(s))&&n[F]+e[F]<=e.remoteSettings.maxConcurrentStreams&&vs(n)}},Ns=(t,e)=>{for(let r=0;r<t.length;r++){let n=t[r];if(e[M].length>0&&e[M].length<n[M].length&&e[M].every(s=>n[M].includes(s))&&e[F]+n[F]<=n.remoteSettings.maxConcurrentStreams)return vs(e),!0}return!1},vs=t=>{t[Re]=!0,t[F]===0&&t.close()},Ve=class t extends Aa{constructor({timeout:e=0,maxSessions:r=Number.POSITIVE_INFINITY,maxEmptySessions:n=10,maxCachedTlsSessions:s=100}={}){super(),this.sessions={},this.queue={},this.timeout=e,this.maxSessions=r,this.maxEmptySessions=n,this._emptySessionCount=0,this._sessionCount=0,this.settings={enablePush:!1,initialWindowSize:1024*1024*32},this.tlsSessionCache=new La({maxSize:s})}get protocol(){return"https:"}normalizeOptions(e){let r="";for(let n=0;n<Ls.length;n++){let s=Ls[n];r+=":",e&&e[s]!==void 0&&(r+=e[s])}return r}_processQueue(){if(this._sessionCount>=this.maxSessions){this.closeEmptySessions(this.maxSessions-this._sessionCount+1);return}for(let e in this.queue)for(let r in this.queue[e]){let n=this.queue[e][r];n.completed||(n.completed=!0,n())}}_isBetterSession(e,r){return e>r}_accept(e,r,n,s){let i=0;for(;i<r.length&&e[F]<e.remoteSettings.maxConcurrentStreams;)r[i].resolve(e),i++;r.splice(0,i),r.length>0&&(this.getSession(n,s,r),r.length=0)}getSession(e,r,n){return new Promise((s,i)=>{Array.isArray(n)&&n.length>0?(n=[...n],s()):n=[{resolve:s,reject:i}];try{if(typeof e=="string")e=new ks(e);else if(!(e instanceof ks))throw new TypeError("The `origin` argument needs to be a string or an URL object");if(r){let{servername:g}=r,{hostname:S}=e;if(g&&S!==g)throw new Error(`Origin ${S} differs from servername ${g}`)}}catch(g){for(let S=0;S<n.length;S++)n[S].reject(g);return}let o=this.normalizeOptions(r),a=e.origin;if(o in this.sessions){let g=this.sessions[o],S=-1,y=-1,w;for(let b=0;b<g.length;b++){let l=g[b],C=l.remoteSettings.maxConcurrentStreams;if(C<S)break;if(!l[M].includes(a))continue;let _=l[F];_>=C||l[Re]||l.destroyed||(w||(S=C),this._isBetterSession(_,y)&&(w=l,y=_))}if(w){this._accept(w,n,a,r);return}}if(o in this.queue){if(a in this.queue[o]){this.queue[o][a].listeners.push(...n);return}}else this.queue[o]={[jt]:0};let h=()=>{o in this.queue&&this.queue[o][a]===u&&(delete this.queue[o][a],--this.queue[o][jt]===0&&delete this.queue[o])},u=async()=>{this._sessionCount++;let g=`${a}:${o}`,S=!1,y;try{let w={...r};w.settings===void 0&&(w.settings=this.settings),w.session===void 0&&(w.session=this.tlsSessionCache.get(g)),y=await(w.createConnection||this.createConnection).call(this,e,w),w.createConnection=()=>y;let l=Ua.connect(e,w);l[F]=0,l[Re]=!1;let C=()=>{let{socket:O}=l,P;return O.servername===!1?(O.servername=O.remoteAddress,P=l.originSet,O.servername=!1):P=l.originSet,P},_=()=>l[F]<l.remoteSettings.maxConcurrentStreams;l.socket.once("session",O=>{this.tlsSessionCache.set(g,O)}),l.once("error",O=>{for(let P=0;P<n.length;P++)n[P].reject(O);this.tlsSessionCache.delete(g)}),l.setTimeout(this.timeout,()=>{l.destroy()}),l.once("close",()=>{if(this._sessionCount--,S){this._emptySessionCount--;let O=this.sessions[o];O.length===1?delete this.sessions[o]:O.splice(O.indexOf(l),1)}else{h();let O=new Error("Session closed without receiving a SETTINGS frame");O.code="HTTP2WRAPPER_NOSETTINGS";for(let P=0;P<n.length;P++)n[P].reject(O)}this._processQueue()});let R=()=>{let O=this.queue[o];if(!O)return;let P=l[M];for(let D=0;D<P.length;D++){let V=P[D];if(V in O){let{listeners:Se,completed:io}=O[V],Et=0;for(;Et<Se.length&&_();)Se[Et].resolve(l),Et++;if(O[V].listeners.splice(0,Et),O[V].listeners.length===0&&!io&&(delete O[V],--O[jt]===0)){delete this.queue[o];break}if(!_())break}}};l.on("origin",()=>{l[M]=C()||[],l[Re]=!1,Ns(this.sessions[o],l),!(l[Re]||!_())&&(R(),_()&&Dr(this.sessions[o],l))}),l.once("remoteSettings",()=>{if(u.destroyed){let O=new Error("Agent has been destroyed");for(let P=0;P<n.length;P++)n[P].reject(O);l.destroy();return}if(l.setLocalWindowSize&&l.setLocalWindowSize(1024*1024*4),l[M]=C()||[],l.socket.encrypted){let O=l[M][0];if(O!==a){let P=new Error(`Requested origin ${a} does not match server ${O}`);for(let D=0;D<n.length;D++)n[D].reject(P);l.destroy();return}}h();{let O=this.sessions;if(o in O){let P=O[o];P.splice(va(P,l,Da),0,l)}else O[o]=[l]}S=!0,this._emptySessionCount++,this.emit("session",l),this._accept(l,n,a,r),l[F]===0&&this._emptySessionCount>this.maxEmptySessions&&this.closeEmptySessions(this._emptySessionCount-this.maxEmptySessions),l.on("remoteSettings",()=>{_()&&(R(),_()&&Dr(this.sessions[o],l))})}),l[Us]=l.request,l.request=(O,P)=>{if(l[Re])throw new Error("The session is gracefully closing. No new streams are allowed.");let D=l[Us](O,P);return l.ref(),l[F]++===0&&this._emptySessionCount--,D.once("close",()=>{if(--l[F]===0&&(this._emptySessionCount++,l.unref(),this._emptySessionCount>this.maxEmptySessions||l[Re])){l.close();return}l.destroyed||l.closed||_()&&!Ns(this.sessions[o],l)&&(Dr(this.sessions[o],l),R(),l[F]===0&&this._processQueue())}),D}}catch(w){h(),this._sessionCount--;for(let b=0;b<n.length;b++)n[b].reject(w)}};u.listeners=n,u.completed=!1,u.destroyed=!1,this.queue[o][a]=u,this.queue[o][jt]++,this._processQueue()})}request(e,r,n,s){return new Promise((i,o)=>{this.getSession(e,r,[{reject:o,resolve:a=>{try{let h=a.request(n,s);Na(h),i(h)}catch(h){o(h)}}}])})}async createConnection(e,r){return t.connect(e,r)}static connect(e,r){r.ALPNProtocols=["h2"];let n=e.port||443,s=e.hostname;typeof r.servername>"u"&&(r.servername=s);let i=ka.connect(n,s,r);return r.socket&&(i._peername={family:void 0,address:void 0,port:n}),i}closeEmptySessions(e=Number.POSITIVE_INFINITY){let r=0,{sessions:n}=this;for(let s in n){let i=n[s];for(let o=0;o<i.length;o++){let a=i[o];if(a[F]===0&&(r++,a.close(),r>=e))return r}}return r}destroy(e){let{sessions:r,queue:n}=this;for(let s in r){let i=r[s];for(let o=0;o<i.length;o++)i[o].destroy(e)}for(let s in n){let i=n[s];for(let o in i)i[o].destroyed=!0}this.queue={},this.tlsSessionCache.clear()}get emptySessionCount(){return this._emptySessionCount}get pendingSessionCount(){return this._sessionCount-this._emptySessionCount}get sessionCount(){return this._sessionCount}};Ve.kCurrentStreamCount=F;Ve.kGracefullyClosing=Re;Ds.exports={Agent:Ve,globalAgent:new Ve}});var Br=I((Zh,Hs)=>{"use strict";var{Readable:Ha}=require("stream"),Hr=class extends Ha{constructor(e,r){super({emitClose:!1,autoDestroy:!0,highWaterMark:r}),this.statusCode=null,this.statusMessage="",this.httpVersion="2.0",this.httpVersionMajor=2,this.httpVersionMinor=0,this.headers={},this.trailers={},this.req=null,this.aborted=!1,this.complete=!1,this.upgrade=null,this.rawHeaders=[],this.rawTrailers=[],this.socket=e,this._dumped=!1}get connection(){return this.socket}set connection(e){this.socket=e}_destroy(e,r){this.readableEnded||(this.aborted=!0),r(),this.req._request.destroy(e)}setTimeout(e,r){return this.req.setTimeout(e,r),this}_dump(){this._dumped||(this._dumped=!0,this.removeAllListeners("data"),this.resume())}_read(){this.req&&this.req._request.resume()}};Hs.exports=Hr});var qs=I((eu,Bs)=>{"use strict";Bs.exports=(t,e,r)=>{for(let n of r)t.on(n,(...s)=>e.emit(n,...s))}});var pt=I((ru,js)=>{"use strict";var ve=(t,e,r)=>{js.exports[e]=class extends t{constructor(...s){super(typeof r=="string"?r:r(s)),this.name=`${super.name} [${e}]`,this.code=e}}};ve(TypeError,"ERR_INVALID_ARG_TYPE",t=>{let e=t[0].includes(".")?"property":"argument",r=t[1],n=Array.isArray(r);return n&&(r=`${r.slice(0,-1).join(", ")} or ${r.slice(-1)}`),`The "${t[0]}" ${e} must be ${n?"one of":"of"} type ${r}. Received ${typeof t[2]}`});ve(TypeError,"ERR_INVALID_PROTOCOL",t=>`Protocol "${t[0]}" not supported. Expected "${t[1]}"`);ve(Error,"ERR_HTTP_HEADERS_SENT",t=>`Cannot ${t[0]} headers after they are sent to the client`);ve(TypeError,"ERR_INVALID_HTTP_TOKEN",t=>`${t[0]} must be a valid HTTP token [${t[1]}]`);ve(TypeError,"ERR_HTTP_INVALID_HEADER_VALUE",t=>`Invalid value "${t[0]} for header "${t[1]}"`);ve(TypeError,"ERR_INVALID_CHAR",t=>`Invalid character in ${t[0]} [${t[1]}]`);ve(Error,"ERR_HTTP2_NO_SOCKET_MANIPULATION","HTTP/2 sockets should not be directly manipulated (e.g. read and written)")});var zs=I((nu,$s)=>{"use strict";$s.exports=t=>{switch(t){case":method":case":scheme":case":authority":case":path":return!0;default:return!1}}});var qr=I((su,Fs)=>{"use strict";var{ERR_INVALID_HTTP_TOKEN:Ba}=pt(),qa=zs(),ja=/^[\^`\-\w!#$%&*+.|~]+$/;Fs.exports=t=>{if(typeof t!="string"||!ja.test(t)&&!qa(t))throw new Ba("Header name",t)}});var jr=I((iu,Ms)=>{"use strict";var{ERR_HTTP_INVALID_HEADER_VALUE:$a,ERR_INVALID_CHAR:za}=pt(),Fa=/[^\t\u0020-\u007E\u0080-\u00FF]/;Ms.exports=(t,e)=>{if(typeof e>"u")throw new $a(e,t);if(Fa.test(e))throw new za("header content",t)}});var Ws=I((ou,Gs)=>{"use strict";var{ERR_HTTP2_NO_SOCKET_MANIPULATION:Vs}=pt(),Ma={has(t,e){let r=t.session===void 0?t:t.session.socket;return e in t||e in r},get(t,e){switch(e){case"on":case"once":case"end":case"emit":case"destroy":return t[e].bind(t);case"writable":case"destroyed":return t[e];case"readable":return t.destroyed?!1:t.readable;case"setTimeout":{let{session:r}=t;return r!==void 0?r.setTimeout.bind(r):t.setTimeout.bind(t)}case"write":case"read":case"pause":case"resume":throw new Vs;default:{let r=t.session===void 0?t:t.session.socket,n=r[e];return typeof n=="function"?n.bind(r):n}}},getPrototypeOf(t){return t.session!==void 0?Reflect.getPrototypeOf(t.session.socket):Reflect.getPrototypeOf(t)},set(t,e,r){switch(e){case"writable":case"readable":case"destroyed":case"on":case"once":case"end":case"emit":case"destroy":return t[e]=r,!0;case"setTimeout":{let{session:n}=t;return n===void 0?t.setTimeout=r:n.setTimeout=r,!0}case"write":case"read":case"pause":case"resume":throw new Vs;default:{let n=t.session===void 0?t:t.session.socket;return n[e]=r,!0}}}};Gs.exports=Ma});var Mr=I((au,Zs)=>{"use strict";var{URL:$r,urlToHttpOptions:Ks}=require("url"),Va=require("http2"),{Writable:Ga}=require("stream"),{Agent:Wa,globalAgent:Ka}=Ne(),Ya=Br(),Qa=qs(),{ERR_INVALID_ARG_TYPE:$t,ERR_INVALID_PROTOCOL:Ja,ERR_HTTP_HEADERS_SENT:Ys}=pt(),Xa=qr(),Za=jr(),ec=Ws(),{HTTP2_HEADER_STATUS:Qs,HTTP2_HEADER_METHOD:Js,HTTP2_HEADER_PATH:Xs,HTTP2_HEADER_AUTHORITY:yt,HTTP2_METHOD_CONNECT:tc}=Va.constants,$=Symbol("headers"),Ge=Symbol("origin"),gt=Symbol("session"),zr=Symbol("options"),zt=Symbol("flushedHeaders"),We=Symbol("jobs"),ft=Symbol("pendingAgentPromise"),Fr=class extends Ga{constructor(e,r,n){if(super({autoDestroy:!1,emitClose:!1}),typeof e=="string"?e=Ks(new $r(e)):e instanceof $r?e=Ks(e):e={...e},typeof r=="function"||r===void 0?(n=r,r=e):r=Object.assign(e,r),r.h2session){if(this[gt]=r.h2session,this[gt].destroyed)throw new Error("The session has been closed already");this.protocol=this[gt].socket.encrypted?"https:":"http:"}else if(r.agent===!1)this.agent=new Wa({maxEmptySessions:0});else if(typeof r.agent>"u"||r.agent===null)this.agent=Ka;else if(typeof r.agent.request=="function")this.agent=r.agent;else throw new $t("options.agent",["http2wrapper.Agent-like Object","undefined","false"],r.agent);if(this.agent&&(this.protocol=this.agent.protocol),r.protocol&&r.protocol!==this.protocol)throw new Ja(r.protocol,this.protocol);r.port||(r.port=r.defaultPort||this.agent&&this.agent.defaultPort||443),r.host=r.hostname||r.host||"localhost",delete r.hostname;let{timeout:s}=r;r.timeout=void 0,this[$]=Object.create(null),this[We]=[],this[ft]=void 0,this.socket=null,this.connection=null,this.method=r.method||"GET",this.method==="CONNECT"&&(r.path==="/"||r.path===void 0)||(this.path=r.path),this.res=null,this.aborted=!1,this.reusedSocket=!1;let{headers:i}=r;if(i)for(let a in i)this.setHeader(a,i[a]);r.auth&&!("authorization"in this[$])&&(this[$].authorization="Basic "+Buffer.from(r.auth).toString("base64")),r.session=r.tlsSession,r.path=r.socketPath,this[zr]=r,this[Ge]=new $r(`${this.protocol}//${r.servername||r.host}:${r.port}`);let o=r._reuseSocket;o&&(r.createConnection=(...a)=>o.destroyed?this.agent.createConnection(...a):o,this.agent.getSession(this[Ge],this[zr]).catch(()=>{})),s&&this.setTimeout(s),n&&this.once("response",n),this[zt]=!1}get method(){return this[$][Js]}set method(e){e&&(this[$][Js]=e.toUpperCase())}get path(){let e=this.method==="CONNECT"?yt:Xs;return this[$][e]}set path(e){if(e){let r=this.method==="CONNECT"?yt:Xs;this[$][r]=e}}get host(){return this[Ge].hostname}set host(e){}get _mustNotHaveABody(){return this.method==="GET"||this.method==="HEAD"||this.method==="DELETE"}_write(e,r,n){if(this._mustNotHaveABody){n(new Error("The GET, HEAD and DELETE methods must NOT have a body"));return}this.flushHeaders();let s=()=>this._request.write(e,r,n);this._request?s():this[We].push(s)}_final(e){this.flushHeaders();let r=()=>{if(this._mustNotHaveABody||this.method==="CONNECT"){e();return}this._request.end(e)};this._request?r():this[We].push(r)}abort(){this.res&&this.res.complete||(this.aborted||process.nextTick(()=>this.emit("abort")),this.aborted=!0,this.destroy())}async _destroy(e,r){this.res&&this.res._dump(),this._request?this._request.destroy():process.nextTick(()=>{this.emit("close")});try{await this[ft]}catch(n){this.aborted&&(e=n)}r(e)}async flushHeaders(){if(this[zt]||this.destroyed)return;this[zt]=!0;let e=this.method===tc,r=n=>{if(this._request=n,this.destroyed){n.destroy();return}e||Qa(n,this,["timeout","continue"]),n.once("error",i=>{this.destroy(i)}),n.once("aborted",()=>{let{res:i}=this;i?(i.aborted=!0,i.emit("aborted"),i.destroy()):this.destroy(new Error("The server aborted the HTTP/2 stream"))});let s=(i,o,a)=>{let h=new Ya(this.socket,n.readableHighWaterMark);this.res=h,h.url=`${this[Ge].origin}${this.path}`,h.req=this,h.statusCode=i[Qs],h.headers=i,h.rawHeaders=a,h.once("end",()=>{h.complete=!0,h.socket=null,h.connection=null}),e?(h.upgrade=!0,this.emit("connect",h,n,Buffer.alloc(0))?this.emit("close"):n.destroy()):(n.on("data",u=>{!h._dumped&&!h.push(u)&&n.pause()}),n.once("end",()=>{this.aborted||h.push(null)}),this.emit("response",h)||h._dump())};n.once("response",s),n.once("headers",i=>this.emit("information",{statusCode:i[Qs]})),n.once("trailers",(i,o,a)=>{let{res:h}=this;if(h===null){s(i,o,a);return}h.trailers=i,h.rawTrailers=a}),n.once("close",()=>{let{aborted:i,res:o}=this;if(o){i&&(o.aborted=!0,o.emit("aborted"),o.destroy());let a=()=>{o.emit("close"),this.destroy(),this.emit("close")};o.readable?o.once("end",a):a();return}if(!this.destroyed){this.destroy(new Error("The HTTP/2 stream has been early terminated")),this.emit("close");return}this.destroy(),this.emit("close")}),this.socket=new Proxy(n,ec);for(let i of this[We])i();this[We].length=0,this.emit("socket",this.socket)};if(!(yt in this[$])&&!e&&(this[$][yt]=this[Ge].host),this[gt])try{r(this[gt].request(this[$]))}catch(n){this.destroy(n)}else{this.reusedSocket=!0;try{let n=this.agent.request(this[Ge],this[zr],this[$]);this[ft]=n,r(await n),this[ft]=!1}catch(n){this[ft]=!1,this.destroy(n)}}}get connection(){return this.socket}set connection(e){this.socket=e}getHeaderNames(){return Object.keys(this[$])}hasHeader(e){if(typeof e!="string")throw new $t("name","string",e);return!!this[$][e.toLowerCase()]}getHeader(e){if(typeof e!="string")throw new $t("name","string",e);return this[$][e.toLowerCase()]}get headersSent(){return this[zt]}removeHeader(e){if(typeof e!="string")throw new $t("name","string",e);if(this.headersSent)throw new Ys("remove");delete this[$][e.toLowerCase()]}setHeader(e,r){if(this.headersSent)throw new Ys("set");Xa(e),Za(e,r);let n=e.toLowerCase();if(n==="connection"){if(r.toLowerCase()==="keep-alive")return;throw new Error(`Invalid 'connection' header: ${r}`)}n==="host"&&this.method==="CONNECT"?this[$][yt]=r:this[$][n]=r}setNoDelay(){}setSocketKeepAlive(){}setTimeout(e,r){let n=()=>this._request.setTimeout(e,r);return this._request?n():this[We].push(n),this}get maxHeadersCount(){if(!this.destroyed&&this._request)return this._request.session.localSettings.maxHeaderListSize}set maxHeadersCount(e){}};Zs.exports=Fr});var ti=I((cu,ei)=>{"use strict";var rc=require("tls");ei.exports=(t={},e=rc.connect)=>new Promise((r,n)=>{let s=!1,i,o=async()=>{await h,i.off("timeout",a),i.off("error",n),t.resolveSocket?(r({alpnProtocol:i.alpnProtocol,socket:i,timeout:s}),s&&(await Promise.resolve(),i.emit("timeout"))):(i.destroy(),r({alpnProtocol:i.alpnProtocol,timeout:s}))},a=async()=>{s=!0,o()},h=(async()=>{try{i=await e(t,o),i.on("error",n),i.once("timeout",a)}catch(u){n(u)}})()})});var ni=I((du,ri)=>{"use strict";var{isIP:nc}=require("net"),sc=require("assert"),ic=t=>{if(t[0]==="["){let r=t.indexOf("]");return sc(r!==-1),t.slice(1,r)}let e=t.indexOf(":");return e===-1?t:t.slice(0,e)};ri.exports=t=>{let e=ic(t);return nc(e)?"":e}});var ui=I((hu,_t)=>{"use strict";var{URL:si,urlToHttpOptions:ii}=require("url"),oi=require("http"),Vr=require("https"),oc=ti(),ac=Nr(),{Agent:cc,globalAgent:dc}=Ne(),hc=Mr(),uc=ni(),ai=vr(),ci=new ac({maxSize:100}),lc=new Map,mc=(t,e,r)=>{e._httpMessage={shouldKeepAlive:!0};let n=()=>{t.emit("free",e,r)};e.on("free",n);let s=()=>{t.removeSocket(e,r)};e.on("close",s);let i=()=>{let{freeSockets:a}=t;for(let h of Object.values(a))if(h.includes(e)){e.destroy();return}};e.on("timeout",i);let o=()=>{t.removeSocket(e,r),e.off("close",s),e.off("free",n),e.off("timeout",i),e.off("agentRemove",o)};e.on("agentRemove",o),t.emit("free",e,r)},di=(t,e=new Map,r=void 0)=>async n=>{let s=`${n.host}:${n.port}:${n.ALPNProtocols.sort()}`;if(!t.has(s)){if(e.has(s))return{alpnProtocol:(await e.get(s)).alpnProtocol};let{path:i}=n;n.path=n.socketPath;let o=oc(n,r);e.set(s,o);try{let a=await o;return t.set(s,a.alpnProtocol),e.delete(s),n.path=i,a}catch(a){throw e.delete(s),n.path=i,a}}return{alpnProtocol:t.get(s)}},hi=di(ci,lc);_t.exports=async(t,e,r)=>{if(typeof t=="string"?t=ii(new si(t)):t instanceof si?t=ii(t):t={...t},typeof e=="function"||e===void 0?(r=e,e=t):e=Object.assign(t,e),e.ALPNProtocols=e.ALPNProtocols||["h2","http/1.1"],!Array.isArray(e.ALPNProtocols)||e.ALPNProtocols.length===0)throw new Error("The `ALPNProtocols` option must be an Array with at least one entry");e.protocol=e.protocol||"https:";let n=e.protocol==="https:";e.host=e.hostname||e.host||"localhost",e.session=e.tlsSession,e.servername=e.servername||uc(e.headers&&e.headers.host||e.host),e.port=e.port||(n?443:80),e._defaultAgent=n?Vr.globalAgent:oi.globalAgent;let s=e.resolveProtocol||hi,{agent:i}=e;if(i!==void 0&&i!==!1&&i.constructor.name!=="Object")throw new Error("The `options.agent` can be only an object `http`, `https` or `http2` properties");if(n){e.resolveSocket=!0;let{socket:o,alpnProtocol:a,timeout:h}=await s(e);if(h){o&&o.destroy();let g=new Error(`Timed out resolving ALPN: ${e.timeout} ms`);throw g.code="ETIMEDOUT",g.ms=e.timeout,g}o&&e.createConnection&&(o.destroy(),o=void 0),delete e.resolveSocket;let u=a==="h2";if(i&&(i=u?i.http2:i.https,e.agent=i),i===void 0&&(i=u?dc:Vr.globalAgent),o)if(i===!1)o.destroy();else{let g=(u?cc:Vr.Agent).prototype.createConnection;i.createConnection===g?u?e._reuseSocket=o:mc(i,o,e):o.destroy()}if(u)return ai(new hc(e,r))}else i&&(e.agent=i.http);return e.headers&&(e.headers={...e.headers},e.headers[":authority"]&&(e.headers.host||(e.headers.host=e.headers[":authority"]),delete e.headers[":authority"]),delete e.headers[":method"],delete e.headers[":scheme"],delete e.headers[":path"]),ai(oi.request(e,r))};_t.exports.protocolCache=ci;_t.exports.resolveProtocol=hi;_t.exports.createResolveProtocol=di});var Gr=I((uu,li)=>{"use strict";var pc=require("stream"),yc=require("tls"),gc=new yc.TLSSocket(new pc.PassThrough)._handle._parentWrap.constructor;li.exports=gc});var Kr=I((lu,mi)=>{"use strict";var Wr=class extends Error{constructor(e,r=""){super(`The proxy server rejected the request with status code ${e} (${r||"empty status message"})`),this.statusCode=e,this.statusMessage=r}};mi.exports=Wr});var yi=I((mu,pi)=>{"use strict";var fc=(t,e,r)=>{if(!r.some(s=>typeof s==="string"?typeof e===s:e instanceof s)){let s=r.map(i=>typeof i=="string"?i:i.name);throw new TypeError(`Expected '${t}' to be a type of ${s.join(" or ")}, got ${typeof e}`)}};pi.exports=fc});var Yr=I((pu,fi)=>{"use strict";var{URL:gi}=require("url"),Ft=yi();fi.exports=(t,e)=>{Ft("proxyOptions",e,["object"]),Ft("proxyOptions.headers",e.headers,["object","undefined"]),Ft("proxyOptions.raw",e.raw,["boolean","undefined"]),Ft("proxyOptions.url",e.url,[gi,"string"]);let r=new gi(e.url);t.proxyOptions={raw:!0,...e,headers:{...e.headers},url:r}}});var Mt=I((yu,_i)=>{"use strict";_i.exports=t=>{let{username:e,password:r}=t.proxyOptions.url;if(e||r){let n=`${e}:${r}`,s=`Basic ${Buffer.from(n).toString("base64")}`;return{"proxy-authorization":s,authorization:s}}return{}}});var Si=I((gu,xi)=>{"use strict";var _c=require("tls"),wc=require("http"),wi=require("https"),bc=Gr(),{globalAgent:Ec}=Ne(),xc=Kr(),bi=Yr(),Sc=Mt(),Ei=(t,e,r)=>{(async()=>{try{let{proxyOptions:n}=t,{url:s,headers:i,raw:o}=n,a=await Ec.request(s,n,{...Sc(t),...i,":method":"CONNECT",":authority":`${e.host}:${e.port}`});a.once("error",r),a.once("response",h=>{let u=h[":status"];if(u!==200){r(new xc(u,""));return}let g=t instanceof wi.Agent;if(o&&g){e.socket=a;let y=_c.connect(e);y.once("close",()=>{a.destroy()}),r(null,y);return}let S=new bc(a);S.encrypted=!1,S._handle.getpeername=y=>{y.family=void 0,y.address=void 0,y.port=void 0},r(null,S)})}catch(n){r(n)}})()},Qr=class extends wc.Agent{constructor(e){super(e),bi(this,e.proxyOptions)}createConnection(e,r){Ei(this,e,r)}},Jr=class extends wi.Agent{constructor(e){super(e),bi(this,e.proxyOptions)}createConnection(e,r){Ei(this,e,r)}};xi.exports={HttpOverHttp2:Qr,HttpsOverHttp2:Jr}});var Zr=I((fu,Oi)=>{"use strict";var{Agent:Oc}=Ne(),Cc=Gr(),Ic=Kr(),Tc=Yr(),Xr=class extends Oc{constructor(e){super(e),Tc(this,e.proxyOptions)}async createConnection(e,r){let n=`${e.hostname}:${e.port||443}`,[s,i,o]=await this._getProxyStream(n);if(i!==200)throw new Ic(i,o);if(this.proxyOptions.raw)r.socket=s;else{let a=new Cc(s);return a.encrypted=!1,a._handle.getpeername=h=>{h.family=void 0,h.address=void 0,h.port=void 0},a}return super.createConnection(e,r)}};Oi.exports=Xr});var Ii=I((_u,Ci)=>{"use strict";var{globalAgent:Rc}=Ne(),Pc=Zr(),Ac=Mt(),kc=t=>new Promise((e,r)=>{t.once("error",r),t.once("response",n=>{t.off("error",r),e(n[":status"])})}),en=class extends Pc{async _getProxyStream(e){let{proxyOptions:r}=this,n={...Ac(this),...r.headers,":method":"CONNECT",":authority":e},s=await Rc.request(r.url,r,n),i=await kc(s);return[s,i,""]}};Ci.exports=en});var Ri=I((wu,Ti)=>{"use strict";var Uc=require("http"),Lc=require("https"),Nc=Zr(),vc=Mt(),Dc=t=>new Promise((e,r)=>{let n=(s,i,o)=>{i.unshift(o),t.off("error",r),e([i,s.statusCode,s.statusMessage])};t.once("error",r),t.once("connect",n)}),Vt=class extends Nc{async _getProxyStream(e){let{proxyOptions:r}=this,{url:n,headers:s}=this.proxyOptions,o=(n.protocol==="https:"?Lc:Uc).request({...r,hostname:n.hostname,port:n.port,path:e,headers:{...vc(this),...s,host:e},method:"CONNECT"}).end();return Dc(o)}};Ti.exports={Http2OverHttp:Vt,Http2OverHttps:Vt}});var Ai=I((bu,Pi)=>{"use strict";var Hc=require("http2"),{Agent:Bc,globalAgent:qc}=Ne(),tn=Mr(),jc=Br(),$c=ui(),{HttpOverHttp2:zc,HttpsOverHttp2:Fc}=Si(),Mc=Ii(),{Http2OverHttp:Vc,Http2OverHttps:Gc}=Ri(),Wc=qr(),Kc=jr(),Yc=(t,e,r)=>new tn(t,e,r),Qc=(t,e,r)=>{let n=new tn(t,e,r);return n.end(),n};Pi.exports={...Hc,ClientRequest:tn,IncomingMessage:jc,Agent:Bc,globalAgent:qc,request:Yc,get:Qc,auto:$c,proxies:{HttpOverHttp2:zc,HttpsOverHttp2:Fc,Http2OverHttp2:Mc,Http2OverHttp:Vc,Http2OverHttps:Gc},validateHeaderName:Wc,validateHeaderValue:Kc}});var Od={};lo(Od,{default:()=>Sd});module.exports=mo(Od);var Zt=N(require("os")),En=require("@raycast/api");var H=require("@raycast/api");var Id=[H.Icon.Globe,H.Icon.Map,H.Icon.Pin,H.Icon.Clock,H.Icon.EditShape,H.Icon.Network,H.Icon.Building],Td=[H.Icon.Info,H.Icon.Cd,H.Icon.Globe,H.Icon.BullsEye,H.Icon.Map,H.Icon.Pin,H.Icon.Clock,H.Icon.EditShape,H.Icon.Network,H.Icon.Building];var bn=require("@raycast/api"),{language:po,showIPv6:Pd,coordinatesFormat:Ad}=(0,bn.getPreferenceValues)();var xn=t=>!(t!=null&&String(t).length>0);function Sn(){let t=Zt.networkInterfaces();for(let e in t){let r=t[e];if(typeof r<"u")for(let n=0;n<r.length;n++){let s=r[n];if(s.family==="IPv4"&&s.address!=="127.0.0.1"&&!s.internal)return s.address}}return null}function On(){let t=Zt.networkInterfaces();for(let e in t){let r=t[e];if(typeof r<"u")for(let n=0;n<r.length;n++){let s=r[n];if(s.family==="IPv6"&&s.address!=="::1"&&!s.internal)return s.address}}return null}var yo=(t,e)=>{let r=new En.Cache({namespace:"Args"});if(typeof t<"u")return r.set(e,t),t;{let n=r.get(e);return typeof n<"u"?n:""}},Cn=(t,e)=>{if(t.length!==e.length)return{args:[]};{let r=[];for(let n=0;n<t.length;n++)r.push(yo(t[n],e[n]));return{args:r}}};var q=require("@raycast/api");var Zi=require("node:util"),eo=N(require("node:dgram"),1),to=N(Bn(),1);var qn=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Po(t){return qn.includes(t)}var Ao=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Blob","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","WeakRef","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","FormData","URLSearchParams","HTMLElement","NaN",...qn];function ko(t){return Ao.includes(t)}var Uo=["null","undefined","string","number","bigint","boolean","symbol"];function Lo(t){return Uo.includes(t)}function qe(t){return e=>typeof e===t}var{toString:No}=Object.prototype,Je=t=>{let e=No.call(t).slice(8,-1);if(/HTML\w+Element/.test(e)&&c.domElement(t))return"HTMLElement";if(ko(e))return e},k=t=>e=>Je(e)===t;function c(t){if(t===null)return"null";switch(typeof t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"NaN":"number";case"boolean":return"boolean";case"function":return"Function";case"bigint":return"bigint";case"symbol":return"symbol";default:}if(c.observable(t))return"Observable";if(c.array(t))return"Array";if(c.buffer(t))return"Buffer";let e=Je(t);if(e)return e;if(t instanceof String||t instanceof Boolean||t instanceof Number)throw new TypeError("Please don't use object wrappers for primitive types");return"Object"}c.undefined=qe("undefined");c.string=qe("string");var vo=qe("number");c.number=t=>vo(t)&&!c.nan(t);c.positiveNumber=t=>c.number(t)&&t>0;c.negativeNumber=t=>c.number(t)&&t<0;c.bigint=qe("bigint");c.function_=qe("function");c.null_=t=>t===null;c.class_=t=>c.function_(t)&&t.toString().startsWith("class ");c.boolean=t=>t===!0||t===!1;c.symbol=qe("symbol");c.numericString=t=>c.string(t)&&!c.emptyStringOrWhitespace(t)&&!Number.isNaN(Number(t));c.array=(t,e)=>Array.isArray(t)?c.function_(e)?t.every(r=>e(r)):!0:!1;c.buffer=t=>t?.constructor?.isBuffer?.(t)??!1;c.blob=t=>k("Blob")(t);c.nullOrUndefined=t=>c.null_(t)||c.undefined(t);c.object=t=>!c.null_(t)&&(typeof t=="object"||c.function_(t));c.iterable=t=>c.function_(t?.[Symbol.iterator]);c.asyncIterable=t=>c.function_(t?.[Symbol.asyncIterator]);c.generator=t=>c.iterable(t)&&c.function_(t?.next)&&c.function_(t?.throw);c.asyncGenerator=t=>c.asyncIterable(t)&&c.function_(t.next)&&c.function_(t.throw);c.nativePromise=t=>k("Promise")(t);var Do=t=>c.function_(t?.then)&&c.function_(t?.catch);c.promise=t=>c.nativePromise(t)||Do(t);c.generatorFunction=k("GeneratorFunction");c.asyncGeneratorFunction=t=>Je(t)==="AsyncGeneratorFunction";c.asyncFunction=t=>Je(t)==="AsyncFunction";c.boundFunction=t=>c.function_(t)&&!t.hasOwnProperty("prototype");c.regExp=k("RegExp");c.date=k("Date");c.error=k("Error");c.map=t=>k("Map")(t);c.set=t=>k("Set")(t);c.weakMap=t=>k("WeakMap")(t);c.weakSet=t=>k("WeakSet")(t);c.weakRef=t=>k("WeakRef")(t);c.int8Array=k("Int8Array");c.uint8Array=k("Uint8Array");c.uint8ClampedArray=k("Uint8ClampedArray");c.int16Array=k("Int16Array");c.uint16Array=k("Uint16Array");c.int32Array=k("Int32Array");c.uint32Array=k("Uint32Array");c.float32Array=k("Float32Array");c.float64Array=k("Float64Array");c.bigInt64Array=k("BigInt64Array");c.bigUint64Array=k("BigUint64Array");c.arrayBuffer=k("ArrayBuffer");c.sharedArrayBuffer=k("SharedArrayBuffer");c.dataView=k("DataView");c.enumCase=(t,e)=>Object.values(e).includes(t);c.directInstanceOf=(t,e)=>Object.getPrototypeOf(t)===e.prototype;c.urlInstance=t=>k("URL")(t);c.urlString=t=>{if(!c.string(t))return!1;try{return new URL(t),!0}catch{return!1}};c.truthy=t=>!!t;c.falsy=t=>!t;c.nan=t=>Number.isNaN(t);c.primitive=t=>c.null_(t)||Lo(typeof t);c.integer=t=>Number.isInteger(t);c.safeInteger=t=>Number.isSafeInteger(t);c.plainObject=t=>{if(typeof t!="object"||t===null)return!1;let e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};c.typedArray=t=>Po(Je(t));var Ho=t=>c.safeInteger(t)&&t>=0;c.arrayLike=t=>!c.nullOrUndefined(t)&&!c.function_(t)&&Ho(t.length);c.tupleLike=(t,e)=>c.array(e)&&c.array(t)&&e.length===t.length?e.every((r,n)=>r(t[n])):!1;c.inRange=(t,e)=>{if(c.number(e))return t>=Math.min(0,e)&&t<=Math.max(e,0);if(c.array(e)&&e.length===2)return t>=Math.min(...e)&&t<=Math.max(...e);throw new TypeError(`Invalid range: ${JSON.stringify(e)}`)};var Bo=1,qo=["innerHTML","ownerDocument","style","attributes","nodeValue"];c.domElement=t=>c.object(t)&&t.nodeType===Bo&&c.string(t.nodeName)&&!c.plainObject(t)&&qo.every(e=>e in t);c.observable=t=>t?t===t[Symbol.observable]?.()||t===t["@@observable"]?.():!1;c.nodeStream=t=>c.object(t)&&c.function_(t.pipe)&&!c.observable(t);c.infinite=t=>t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY;var jn=t=>e=>c.integer(e)&&Math.abs(e%2)===t;c.evenInteger=jn(0);c.oddInteger=jn(1);c.emptyArray=t=>c.array(t)&&t.length===0;c.nonEmptyArray=t=>c.array(t)&&t.length>0;c.emptyString=t=>c.string(t)&&t.length===0;var jo=t=>c.string(t)&&!/\S/.test(t);c.emptyStringOrWhitespace=t=>c.emptyString(t)||jo(t);c.nonEmptyString=t=>c.string(t)&&t.length>0;c.nonEmptyStringAndNotWhitespace=t=>c.string(t)&&!c.emptyStringOrWhitespace(t);c.emptyObject=t=>c.object(t)&&!c.map(t)&&!c.set(t)&&Object.keys(t).length===0;c.nonEmptyObject=t=>c.object(t)&&!c.map(t)&&!c.set(t)&&Object.keys(t).length>0;c.emptySet=t=>c.set(t)&&t.size===0;c.nonEmptySet=t=>c.set(t)&&t.size>0;c.emptyMap=t=>c.map(t)&&t.size===0;c.nonEmptyMap=t=>c.map(t)&&t.size>0;c.propertyKey=t=>c.any([c.string,c.number,c.symbol],t);c.formData=t=>k("FormData")(t);c.urlSearchParams=t=>k("URLSearchParams")(t);var $n=(t,e,r)=>{if(!c.function_(e))throw new TypeError(`Invalid predicate: ${JSON.stringify(e)}`);if(r.length===0)throw new TypeError("Invalid number of values");return t.call(r,e)};c.any=(t,...e)=>(c.array(t)?t:[t]).some(n=>$n(Array.prototype.some,n,e));c.all=(t,...e)=>$n(Array.prototype.every,t,e);var p=(t,e,r,n={})=>{if(!t){let{multipleValues:s}=n,i=s?`received values of types ${[...new Set(r.map(o=>`\`${c(o)}\``))].join(", ")}`:`received value of type \`${c(r)}\``;throw new TypeError(`Expected value which is \`${e}\`, ${i}.`)}},m={undefined:t=>p(c.undefined(t),"undefined",t),string:t=>p(c.string(t),"string",t),number:t=>p(c.number(t),"number",t),positiveNumber:t=>p(c.positiveNumber(t),"positive number",t),negativeNumber:t=>p(c.negativeNumber(t),"negative number",t),bigint:t=>p(c.bigint(t),"bigint",t),function_:t=>p(c.function_(t),"Function",t),null_:t=>p(c.null_(t),"null",t),class_:t=>p(c.class_(t),"Class",t),boolean:t=>p(c.boolean(t),"boolean",t),symbol:t=>p(c.symbol(t),"symbol",t),numericString:t=>p(c.numericString(t),"string with a number",t),array:(t,e)=>{p(c.array(t),"Array",t),e&&t.forEach(e)},buffer:t=>p(c.buffer(t),"Buffer",t),blob:t=>p(c.blob(t),"Blob",t),nullOrUndefined:t=>p(c.nullOrUndefined(t),"null or undefined",t),object:t=>p(c.object(t),"Object",t),iterable:t=>p(c.iterable(t),"Iterable",t),asyncIterable:t=>p(c.asyncIterable(t),"AsyncIterable",t),generator:t=>p(c.generator(t),"Generator",t),asyncGenerator:t=>p(c.asyncGenerator(t),"AsyncGenerator",t),nativePromise:t=>p(c.nativePromise(t),"native Promise",t),promise:t=>p(c.promise(t),"Promise",t),generatorFunction:t=>p(c.generatorFunction(t),"GeneratorFunction",t),asyncGeneratorFunction:t=>p(c.asyncGeneratorFunction(t),"AsyncGeneratorFunction",t),asyncFunction:t=>p(c.asyncFunction(t),"AsyncFunction",t),boundFunction:t=>p(c.boundFunction(t),"Function",t),regExp:t=>p(c.regExp(t),"RegExp",t),date:t=>p(c.date(t),"Date",t),error:t=>p(c.error(t),"Error",t),map:t=>p(c.map(t),"Map",t),set:t=>p(c.set(t),"Set",t),weakMap:t=>p(c.weakMap(t),"WeakMap",t),weakSet:t=>p(c.weakSet(t),"WeakSet",t),weakRef:t=>p(c.weakRef(t),"WeakRef",t),int8Array:t=>p(c.int8Array(t),"Int8Array",t),uint8Array:t=>p(c.uint8Array(t),"Uint8Array",t),uint8ClampedArray:t=>p(c.uint8ClampedArray(t),"Uint8ClampedArray",t),int16Array:t=>p(c.int16Array(t),"Int16Array",t),uint16Array:t=>p(c.uint16Array(t),"Uint16Array",t),int32Array:t=>p(c.int32Array(t),"Int32Array",t),uint32Array:t=>p(c.uint32Array(t),"Uint32Array",t),float32Array:t=>p(c.float32Array(t),"Float32Array",t),float64Array:t=>p(c.float64Array(t),"Float64Array",t),bigInt64Array:t=>p(c.bigInt64Array(t),"BigInt64Array",t),bigUint64Array:t=>p(c.bigUint64Array(t),"BigUint64Array",t),arrayBuffer:t=>p(c.arrayBuffer(t),"ArrayBuffer",t),sharedArrayBuffer:t=>p(c.sharedArrayBuffer(t),"SharedArrayBuffer",t),dataView:t=>p(c.dataView(t),"DataView",t),enumCase:(t,e)=>p(c.enumCase(t,e),"EnumCase",t),urlInstance:t=>p(c.urlInstance(t),"URL",t),urlString:t=>p(c.urlString(t),"string with a URL",t),truthy:t=>p(c.truthy(t),"truthy",t),falsy:t=>p(c.falsy(t),"falsy",t),nan:t=>p(c.nan(t),"NaN",t),primitive:t=>p(c.primitive(t),"primitive",t),integer:t=>p(c.integer(t),"integer",t),safeInteger:t=>p(c.safeInteger(t),"integer",t),plainObject:t=>p(c.plainObject(t),"plain object",t),typedArray:t=>p(c.typedArray(t),"TypedArray",t),arrayLike:t=>p(c.arrayLike(t),"array-like",t),tupleLike:(t,e)=>p(c.tupleLike(t,e),"tuple-like",t),domElement:t=>p(c.domElement(t),"HTMLElement",t),observable:t=>p(c.observable(t),"Observable",t),nodeStream:t=>p(c.nodeStream(t),"Node.js Stream",t),infinite:t=>p(c.infinite(t),"infinite number",t),emptyArray:t=>p(c.emptyArray(t),"empty array",t),nonEmptyArray:t=>p(c.nonEmptyArray(t),"non-empty array",t),emptyString:t=>p(c.emptyString(t),"empty string",t),emptyStringOrWhitespace:t=>p(c.emptyStringOrWhitespace(t),"empty string or whitespace",t),nonEmptyString:t=>p(c.nonEmptyString(t),"non-empty string",t),nonEmptyStringAndNotWhitespace:t=>p(c.nonEmptyStringAndNotWhitespace(t),"non-empty string and not whitespace",t),emptyObject:t=>p(c.emptyObject(t),"empty object",t),nonEmptyObject:t=>p(c.nonEmptyObject(t),"non-empty object",t),emptySet:t=>p(c.emptySet(t),"empty set",t),nonEmptySet:t=>p(c.nonEmptySet(t),"non-empty set",t),emptyMap:t=>p(c.emptyMap(t),"empty map",t),nonEmptyMap:t=>p(c.nonEmptyMap(t),"non-empty map",t),propertyKey:t=>p(c.propertyKey(t),"PropertyKey",t),formData:t=>p(c.formData(t),"FormData",t),urlSearchParams:t=>p(c.urlSearchParams(t),"URLSearchParams",t),evenInteger:t=>p(c.evenInteger(t),"even integer",t),oddInteger:t=>p(c.oddInteger(t),"odd integer",t),directInstanceOf:(t,e)=>p(c.directInstanceOf(t,e),"T",t),inRange:(t,e)=>p(c.inRange(t,e),"in range",t),any:(t,...e)=>p(c.any(t,...e),"predicate returns truthy for any value",e,{multipleValues:!0}),all:(t,...e)=>p(c.all(t,...e),"predicate returns truthy for all values",e,{multipleValues:!0})};Object.defineProperties(c,{class:{value:c.class_},function:{value:c.function_},null:{value:c.null_}});Object.defineProperties(m,{class:{value:m.class_},function:{value:m.function_},null:{value:m.null_}});var d=c;var zi=require("node:events");var dr=class extends Error{constructor(e){super(e||"Promise was canceled"),this.name="CancelError"}get isCanceled(){return!0}},je=class t{static fn(e){return(...r)=>new t((n,s,i)=>{r.push(i),e(...r).then(n,s)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((r,n)=>{this._reject=n;let s=a=>{(!this._isCanceled||!o.shouldReject)&&(this._isPending=!1,r(a))},i=a=>{this._isPending=!1,n(a)},o=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};Object.defineProperties(o,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(s,i,o)})}then(e,r){return this._promise.then(e,r)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let r of this._cancelHandlers)r()}catch(r){this._reject(r);return}this._rejectOnCancel&&this._reject(new dr(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(je.prototype,Promise.prototype);function $o(t){return d.object(t)&&"_onResponse"in t}var L=class extends Error{constructor(e,r,n){if(super(e),Object.defineProperty(this,"input",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stack",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Error.captureStackTrace(this,this.constructor),this.name="RequestError",this.code=r.code??"ERR_GOT_REQUEST_ERROR",this.input=r.input,$o(n)?(Object.defineProperty(this,"request",{enumerable:!1,value:n}),Object.defineProperty(this,"response",{enumerable:!1,value:n.response}),this.options=n.options):this.options=n,this.timings=this.request?.timings,d.string(r.stack)&&d.string(this.stack)){let s=this.stack.indexOf(this.message)+this.message.length,i=this.stack.slice(s).split(`
`).reverse(),o=r.stack.slice(r.stack.indexOf(r.message)+r.message.length).split(`
`).reverse();for(;o.length>0&&o[0]===i[0];)i.shift();this.stack=`${this.stack.slice(0,s)}${i.reverse().join(`
`)}${o.reverse().join(`
`)}`}}},Ct=class extends L{constructor(e){super(`Redirected ${e.options.maxRedirects} times. Aborting.`,{},e),this.name="MaxRedirectsError",this.code="ERR_TOO_MANY_REDIRECTS"}},Ce=class extends L{constructor(e){super(`Response code ${e.statusCode} (${e.statusMessage})`,{},e.request),this.name="HTTPError",this.code="ERR_NON_2XX_3XX_RESPONSE"}},It=class extends L{constructor(e,r){super(e.message,e,r),this.name="CacheError",this.code=this.code==="ERR_GOT_REQUEST_ERROR"?"ERR_CACHE_ACCESS":this.code}},Xe=class extends L{constructor(e,r){super(e.message,e,r),this.name="UploadError",this.code=this.code==="ERR_GOT_REQUEST_ERROR"?"ERR_UPLOAD":this.code}},Tt=class extends L{constructor(e,r,n){super(e.message,e,n),Object.defineProperty(this,"timings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"event",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="TimeoutError",this.event=e.event,this.timings=r}},Ze=class extends L{constructor(e,r){super(e.message,e,r),this.name="ReadError",this.code=this.code==="ERR_GOT_REQUEST_ERROR"?"ERR_READING_RESPONSE_STREAM":this.code}},Rt=class extends L{constructor(e){super("Retrying",{},e),this.name="RetryError",this.code="ERR_RETRYING"}},Pt=class extends L{constructor(e){super("This operation was aborted.",{},e),this.code="ERR_ABORTED",this.name="AbortError"}};var on=N(require("node:process"),1),Qt=require("node:buffer"),qi=require("node:stream"),bt=N(require("node:http"),1);var Fn=require("events"),Mn=require("util"),Vn=N(zn(),1),Fo=t=>{if(t.timings)return t.timings;let e={start:Date.now(),socket:void 0,lookup:void 0,connect:void 0,secureConnect:void 0,upload:void 0,response:void 0,end:void 0,error:void 0,abort:void 0,phases:{wait:void 0,dns:void 0,tcp:void 0,tls:void 0,request:void 0,firstByte:void 0,download:void 0,total:void 0}};t.timings=e;let r=o=>{o.once(Fn.errorMonitor,()=>{e.error=Date.now(),e.phases.total=e.error-e.start})};r(t);let n=()=>{e.abort=Date.now(),e.phases.total=e.abort-e.start};t.prependOnceListener("abort",n);let s=o=>{if(e.socket=Date.now(),e.phases.wait=e.socket-e.start,Mn.types.isProxy(o))return;let a=()=>{e.lookup=Date.now(),e.phases.dns=e.lookup-e.socket};o.prependOnceListener("lookup",a),(0,Vn.default)(o,{connect:()=>{e.connect=Date.now(),e.lookup===void 0&&(o.removeListener("lookup",a),e.lookup=e.connect,e.phases.dns=e.lookup-e.socket),e.phases.tcp=e.connect-e.lookup},secureConnect:()=>{e.secureConnect=Date.now(),e.phases.tls=e.secureConnect-e.connect}})};t.socket?s(t.socket):t.prependOnceListener("socket",s);let i=()=>{e.upload=Date.now(),e.phases.request=e.upload-(e.secureConnect??e.connect)};return t.writableFinished?i():t.prependOnceListener("finish",i),t.prependOnceListener("response",o=>{e.response=Date.now(),e.phases.firstByte=e.response-e.upload,o.timings=e,r(o),o.prependOnceListener("end",()=>{t.off("abort",n),o.off("aborted",n),!e.phases.total&&(e.end=Date.now(),e.phases.download=e.end-e.response,e.phases.total=e.end-e.start)}),o.prependOnceListener("aborted",n)}),e},Gn=Fo;var ss=N(require("node:events"),1),tt=N(require("node:url"),1),is=N(require("node:crypto"),1),Lt=N(require("node:stream"),1);var Mo="text/plain",Vo="us-ascii",mr=(t,e)=>e.some(r=>r instanceof RegExp?r.test(t):r===t),Go=new Set(["https:","http:","file:"]),Wo=t=>{try{let{protocol:e}=new URL(t);return e.endsWith(":")&&!e.includes(".")&&!Go.has(e)}catch{return!1}},Ko=(t,{stripHash:e})=>{let r=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(t);if(!r)throw new Error(`Invalid URL: ${t}`);let{type:n,data:s,hash:i}=r.groups,o=n.split(";");i=e?"":i;let a=!1;o[o.length-1]==="base64"&&(o.pop(),a=!0);let h=o.shift()?.toLowerCase()??"",g=[...o.map(S=>{let[y,w=""]=S.split("=").map(b=>b.trim());return y==="charset"&&(w=w.toLowerCase(),w===Vo)?"":`${y}${w?`=${w}`:""}`}).filter(Boolean)];return a&&g.push("base64"),(g.length>0||h&&h!==Mo)&&g.unshift(h),`data:${g.join(";")},${a?s.trim():s}${i?`#${i}`:""}`};function pr(t,e){if(e={defaultProtocol:"http",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,removeExplicitPort:!1,sortQueryParameters:!0,...e},typeof e.defaultProtocol=="string"&&!e.defaultProtocol.endsWith(":")&&(e.defaultProtocol=`${e.defaultProtocol}:`),t=t.trim(),/^data:/i.test(t))return Ko(t,e);if(Wo(t))return t;let r=t.startsWith("//");!r&&/^\.*\//.test(t)||(t=t.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,e.defaultProtocol));let s=new URL(t);if(e.forceHttp&&e.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(e.forceHttp&&s.protocol==="https:"&&(s.protocol="http:"),e.forceHttps&&s.protocol==="http:"&&(s.protocol="https:"),e.stripAuthentication&&(s.username="",s.password=""),e.stripHash?s.hash="":e.stripTextFragment&&(s.hash=s.hash.replace(/#?:~:text.*?$/i,"")),s.pathname){let o=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,a=0,h="";for(;;){let g=o.exec(s.pathname);if(!g)break;let S=g[0],y=g.index,w=s.pathname.slice(a,y);h+=w.replace(/\/{2,}/g,"/"),h+=S,a=y+S.length}let u=s.pathname.slice(a,s.pathname.length);h+=u.replace(/\/{2,}/g,"/"),s.pathname=h}if(s.pathname)try{s.pathname=decodeURI(s.pathname)}catch{}if(e.removeDirectoryIndex===!0&&(e.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(e.removeDirectoryIndex)&&e.removeDirectoryIndex.length>0){let o=s.pathname.split("/"),a=o[o.length-1];mr(a,e.removeDirectoryIndex)&&(o=o.slice(0,-1),s.pathname=o.slice(1).join("/")+"/")}if(s.hostname&&(s.hostname=s.hostname.replace(/\.$/,""),e.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(s.hostname)&&(s.hostname=s.hostname.replace(/^www\./,""))),Array.isArray(e.removeQueryParameters))for(let o of[...s.searchParams.keys()])mr(o,e.removeQueryParameters)&&s.searchParams.delete(o);if(!Array.isArray(e.keepQueryParameters)&&e.removeQueryParameters===!0&&(s.search=""),Array.isArray(e.keepQueryParameters)&&e.keepQueryParameters.length>0)for(let o of[...s.searchParams.keys()])mr(o,e.keepQueryParameters)||s.searchParams.delete(o);if(e.sortQueryParameters){s.searchParams.sort();try{s.search=decodeURIComponent(s.search)}catch{}}e.removeTrailingSlash&&(s.pathname=s.pathname.replace(/\/$/,"")),e.removeExplicitPort&&s.port&&(s.port="");let i=t;return t=s.toString(),!e.removeSingleSlash&&s.pathname==="/"&&!i.endsWith("/")&&s.hash===""&&(t=t.replace(/\/$/,"")),(e.removeTrailingSlash||s.pathname==="/")&&s.hash===""&&e.removeSingleSlash&&(t=t.replace(/\/$/,"")),r&&!e.normalizeProtocol&&(t=t.replace(/^http:\/\//,"//")),e.stripProtocol&&(t=t.replace(/^(?:https?:)?\/\//,"")),t}var os=N(gr(),1),Ut=N(Qn(),1);var Jn=require("node:stream");function $e(t){return Object.fromEntries(Object.entries(t).map(([e,r])=>[e.toLowerCase(),r]))}var ze=class extends Jn.Readable{statusCode;headers;body;url;constructor({statusCode:e,headers:r,body:n,url:s}){if(typeof e!="number")throw new TypeError("Argument `statusCode` should be a number");if(typeof r!="object")throw new TypeError("Argument `headers` should be an object");if(!(n instanceof Uint8Array))throw new TypeError("Argument `body` should be a buffer");if(typeof s!="string")throw new TypeError("Argument `url` should be a string");super({read(){this.push(n),this.push(null)}}),this.statusCode=e,this.headers=$e(r),this.body=n,this.url=s}};var rt=N(rs(),1);var ha=["aborted","complete","headers","httpVersion","httpVersionMinor","httpVersionMajor","method","rawHeaders","rawTrailers","setTimeout","socket","statusCode","statusMessage","trailers","url"];function br(t,e){if(e._readableState.autoDestroy)throw new Error("The second stream must have the `autoDestroy` option set to `false`");let r=new Set([...Object.keys(t),...ha]),n={};for(let s of r)s in e||(n[s]={get(){let i=t[s];return typeof i=="function"?i.bind(t):i},set(i){t[s]=i},enumerable:!0,configurable:!1});return Object.defineProperties(e,n),t.once("aborted",()=>{e.destroy(),e.emit("aborted")}),t.once("close",()=>{t.complete&&e.readable?e.once("end",()=>{e.emit("close")}):e.emit("close")}),e}var kt=class extends Error{constructor(e){super(e.message),Object.assign(this,e)}},xe=class extends Error{constructor(e){super(e.message),Object.assign(this,e)}};var xr=class{constructor(e,r){this.hooks=new Map,this.request=()=>(n,s)=>{let i;if(typeof n=="string")i=Er(tt.default.parse(n)),n={};else if(n instanceof tt.default.URL)i=Er(tt.default.parse(n.toString())),n={};else{let[y,...w]=(n.path??"").split("?"),b=w.length>0?`?${w.join("?")}`:"";i=Er({...n,pathname:y,search:b})}n={headers:{},method:"GET",cache:!0,strictTtl:!1,automaticFailover:!1,...n,...ma(i)},n.headers=Object.fromEntries(ua(n.headers).map(([y,w])=>[y.toLowerCase(),w]));let o=new ss.default,a=pr(tt.default.format(i),{stripWWW:!1,removeTrailingSlash:!1,stripAuthentication:!1}),h=`${n.method}:${a}`;n.body&&n.method!==void 0&&["POST","PATCH","PUT"].includes(n.method)&&(n.body instanceof Lt.default.Readable?n.cache=!1:h+=`:${is.default.createHash("md5").update(n.body).digest("hex")}`);let u=!1,g=!1,S=y=>{g=!0;let w=!1,b=()=>{},l=new Promise(_=>{b=()=>{w||(w=!0,_())}}),C=async _=>{if(u){_.status=_.statusCode;let O=Ut.default.fromObject(u.cachePolicy).revalidatedPolicy(y,_);if(!O.modified){_.resume(),await new Promise(D=>{_.once("end",D)});let P=ns(O.policy.responseHeaders());_=new ze({statusCode:u.statusCode,headers:P,body:u.body,url:u.url}),_.cachePolicy=O.policy,_.fromCache=!0}}_.fromCache||(_.cachePolicy=new Ut.default(y,_,y),_.fromCache=!1);let R;y.cache&&_.cachePolicy.storable()?(R=la(_),(async()=>{try{let O=os.default.buffer(_);await Promise.race([l,new Promise(Se=>_.once("end",Se)),new Promise(Se=>_.once("close",Se))]);let P=await O,D={url:_.url,statusCode:_.fromCache?u.statusCode:_.statusCode,body:P,cachePolicy:_.cachePolicy.toObject()},V=y.strictTtl?_.cachePolicy.timeToLive():void 0;if(y.maxTtl&&(V=V?Math.min(V,y.maxTtl):y.maxTtl),this.hooks.size>0)for(let Se of this.hooks.keys())D=await this.runHook(Se,D,_);await this.cache.set(h,D,V)}catch(O){o.emit("error",new xe(O))}})()):y.cache&&u&&(async()=>{try{await this.cache.delete(h)}catch(O){o.emit("error",new xe(O))}})(),o.emit("response",R??_),typeof s=="function"&&s(R??_)};try{let _=this.cacheRequest(y,C);_.once("error",b),_.once("abort",b),_.once("destroy",b),o.emit("request",_)}catch(_){o.emit("error",new kt(_))}};return(async()=>{let y=async b=>{await Promise.resolve();let l=b.cache?await this.cache.get(h):void 0;if(l===void 0&&!b.forceRefresh){S(b);return}let C=Ut.default.fromObject(l.cachePolicy);if(C.satisfiesWithoutRevalidation(b)&&!b.forceRefresh){let _=ns(C.responseHeaders()),R=new ze({statusCode:l.statusCode,headers:_,body:l.body,url:l.url});R.cachePolicy=C,R.fromCache=!0,o.emit("response",R),typeof s=="function"&&s(R)}else C.satisfiesWithoutRevalidation(b)&&Date.now()>=C.timeToLive()&&b.forceRefresh?(await this.cache.delete(h),b.headers=C.revalidationHeaders(b),S(b)):(u=l,b.headers=C.revalidationHeaders(b),S(b))},w=b=>o.emit("error",new xe(b));if(this.cache instanceof rt.default){let b=this.cache;b.once("error",w),o.on("error",()=>b.removeListener("error",w)),o.on("response",()=>b.removeListener("error",w))}try{await y(n)}catch(b){n.automaticFailover&&!g&&S(n),o.emit("error",new xe(b))}})(),o},this.addHook=(n,s)=>{this.hooks.has(n)||this.hooks.set(n,s)},this.removeHook=n=>this.hooks.delete(n),this.getHook=n=>this.hooks.get(n),this.runHook=async(n,...s)=>this.hooks.get(n)?.(...s),r instanceof rt.default?this.cache=r:typeof r=="string"?this.cache=new rt.default({uri:r,namespace:"cacheable-request"}):this.cache=new rt.default({store:r,namespace:"cacheable-request"}),this.request=this.request.bind(this),this.cacheRequest=e}},ua=Object.entries,la=t=>{let e=new Lt.PassThrough({autoDestroy:!1});return br(t,e),t.pipe(e)},ma=t=>{let e={...t};return e.path=`${t.pathname||"/"}${t.search||""}`,delete e.pathname,delete e.search,e},Er=t=>({protocol:t.protocol,auth:t.auth,hostname:t.hostname||t.host||"localhost",port:t.port,pathname:t.pathname,search:t.search}),ns=t=>{let e=[];for(let r of Object.keys(t))e[r.toLowerCase()]=t[r];return e},as=xr;var ji=N(us(),1);var $i=N(gr(),1);var Q=t=>typeof t=="function";var _a=t=>Q(t[Symbol.asyncIterator]);async function*wa(t){let e=t.getReader();for(;;){let{done:r,value:n}=await e.read();if(r)break;yield n}}var ls=t=>{if(_a(t))return t;if(Q(t.getReader))return wa(t);throw new TypeError("Unsupported data source: Expected either ReadableStream or async iterable.")};var ms="abcdefghijklmnopqrstuvwxyz0123456789";function ps(){let t=16,e="";for(;t--;)e+=ms[Math.random()*ms.length<<0];return e}var Or=t=>String(t).replace(/\r|\n/g,(e,r,n)=>e==="\r"&&n[r+1]!==`
`||e===`
`&&n[r-1]!=="\r"?`\r
`:e);var ba=t=>Object.prototype.toString.call(t).slice(8,-1).toLowerCase();function Cr(t){if(ba(t)!=="object")return!1;let e=Object.getPrototypeOf(t);return e==null?!0:(e.constructor&&e.constructor.toString())===Object.toString()}function ys(t,e){if(typeof e=="string"){for(let[r,n]of Object.entries(t))if(e.toLowerCase()===r.toLowerCase())return n}}var gs=t=>new Proxy(t,{get:(e,r)=>ys(e,r),has:(e,r)=>ys(e,r)!==void 0});var Fe=t=>!!(t&&Q(t.constructor)&&t[Symbol.toStringTag]==="FormData"&&Q(t.append)&&Q(t.getAll)&&Q(t.entries)&&Q(t[Symbol.iterator]));var Ir=t=>String(t).replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/"/g,"%22");var Ie=t=>!!(t&&typeof t=="object"&&Q(t.constructor)&&t[Symbol.toStringTag]==="File"&&Q(t.stream)&&t.name!=null);var nt=function(t,e,r,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(t,r):s?s.value=r:e.set(t,r),r},U=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},st,Te,it,Nt,ot,Le,at,ct,vt,Tr,fs,Ea={enableAdditionalHeaders:!1},Dt={writable:!1,configurable:!1},Ht=class{constructor(e,r,n){if(st.add(this),Te.set(this,`\r
`),it.set(this,void 0),Nt.set(this,void 0),ot.set(this,"-".repeat(2)),Le.set(this,new TextEncoder),at.set(this,void 0),ct.set(this,void 0),vt.set(this,void 0),!Fe(e))throw new TypeError("Expected first argument to be a FormData instance.");let s;if(Cr(r)?n=r:s=r,s||(s=ps()),typeof s!="string")throw new TypeError("Expected boundary argument to be a string.");if(n&&!Cr(n))throw new TypeError("Expected options argument to be an object.");nt(this,ct,Array.from(e.entries()),"f"),nt(this,vt,{...Ea,...n},"f"),nt(this,it,U(this,Le,"f").encode(U(this,Te,"f")),"f"),nt(this,Nt,U(this,it,"f").byteLength,"f"),this.boundary=`form-data-boundary-${s}`,this.contentType=`multipart/form-data; boundary=${this.boundary}`,nt(this,at,U(this,Le,"f").encode(`${U(this,ot,"f")}${this.boundary}${U(this,ot,"f")}${U(this,Te,"f").repeat(2)}`),"f");let i={"Content-Type":this.contentType},o=U(this,st,"m",fs).call(this);o&&(this.contentLength=o,i["Content-Length"]=o),this.headers=gs(Object.freeze(i)),Object.defineProperties(this,{boundary:Dt,contentType:Dt,contentLength:Dt,headers:Dt})}getContentLength(){return this.contentLength==null?void 0:Number(this.contentLength)}*values(){for(let[e,r]of U(this,ct,"f")){let n=Ie(r)?r:U(this,Le,"f").encode(Or(r));yield U(this,st,"m",Tr).call(this,e,n),yield n,yield U(this,it,"f")}yield U(this,at,"f")}async*encode(){for(let e of this.values())Ie(e)?yield*ls(e.stream()):yield e}[(Te=new WeakMap,it=new WeakMap,Nt=new WeakMap,ot=new WeakMap,Le=new WeakMap,at=new WeakMap,ct=new WeakMap,vt=new WeakMap,st=new WeakSet,Tr=function(r,n){let s="";s+=`${U(this,ot,"f")}${this.boundary}${U(this,Te,"f")}`,s+=`Content-Disposition: form-data; name="${Ir(r)}"`,Ie(n)&&(s+=`; filename="${Ir(n.name)}"${U(this,Te,"f")}`,s+=`Content-Type: ${n.type||"application/octet-stream"}`);let i=Ie(n)?n.size:n.byteLength;return U(this,vt,"f").enableAdditionalHeaders===!0&&i!=null&&!isNaN(i)&&(s+=`${U(this,Te,"f")}Content-Length: ${Ie(n)?n.size:n.byteLength}`),U(this,Le,"f").encode(`${s}${U(this,Te,"f").repeat(2)}`)},fs=function(){let r=0;for(let[n,s]of U(this,ct,"f")){let i=Ie(s)?s:U(this,Le,"f").encode(Or(s)),o=Ie(i)?i.size:i.byteLength;if(o==null||isNaN(o))return;r+=U(this,st,"m",Tr).call(this,n,i).byteLength,r+=o,r+=U(this,Nt,"f")}return String(r+U(this,at,"f").byteLength)},Symbol.iterator)](){return this.values()}[Symbol.asyncIterator](){return this.encode()}};var _s=require("node:buffer"),ws=require("node:util");function dt(t){return d.nodeStream(t)&&d.function_(t.getBoundary)}async function Rr(t,e){if(e&&"content-length"in e)return Number(e["content-length"]);if(!t)return 0;if(d.string(t))return _s.Buffer.byteLength(t);if(d.buffer(t))return t.length;if(dt(t))return(0,ws.promisify)(t.getLength.bind(t))()}function ht(t,e,r){let n={};for(let s of r){let i=(...o)=>{e.emit(s,...o)};n[s]=i,t.on(s,i)}return()=>{for(let[s,i]of Object.entries(n))t.off(s,i)}}var Es=N(require("node:net"),1);function Pr(){let t=[];return{once(e,r,n){e.once(r,n),t.push({origin:e,event:r,fn:n})},unhandleAll(){for(let e of t){let{origin:r,event:n,fn:s}=e;r.removeListener(n,s)}t.length=0}}}var bs=Symbol("reentry"),xa=()=>{},ut=class extends Error{constructor(e,r){super(`Timeout awaiting '${r}' for ${e}ms`),Object.defineProperty(this,"event",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="TimeoutError",this.code="ETIMEDOUT"}};function Ar(t,e,r){if(bs in t)return xa;t[bs]=!0;let n=[],{once:s,unhandleAll:i}=Pr(),o=(l,C,_)=>{let R=setTimeout(C,l,l,_);R.unref?.();let O=()=>{clearTimeout(R)};return n.push(O),O},{host:a,hostname:h}=r,u=(l,C)=>{t.destroy(new ut(l,C))},g=()=>{for(let l of n)l();i()};if(t.once("error",l=>{if(g(),t.listenerCount("error")===0)throw l}),e.request!==void 0){let l=o(e.request,u,"request");s(t,"response",C=>{s(C,"end",l)})}if(e.socket!==void 0){let{socket:l}=e,C=()=>{u(l,"socket")};t.setTimeout(l,C),n.push(()=>{t.removeListener("timeout",C)})}let S=e.lookup!==void 0,y=e.connect!==void 0,w=e.secureConnect!==void 0,b=e.send!==void 0;return(S||y||w||b)&&s(t,"socket",l=>{let{socketPath:C}=t;if(l.connecting){let _=!!(C??Es.default.isIP(h??a??"")!==0);if(S&&!_&&l.address().address===void 0){let R=o(e.lookup,u,"lookup");s(l,"lookup",R)}if(y){let R=()=>o(e.connect,u,"connect");_?s(l,"connect",R()):s(l,"lookup",O=>{O===null&&s(l,"connect",R())})}w&&r.protocol==="https:"&&s(l,"connect",()=>{let R=o(e.secureConnect,u,"secureConnect");s(l,"secureConnect",R)})}if(b){let _=()=>o(e.send,u,"send");l.connecting?s(l,"connect",()=>{s(t,"upload-complete",_())}):s(t,"upload-complete",_())}}),e.response!==void 0&&s(t,"upload-complete",()=>{let l=o(e.response,u,"response");s(t,"response",l)}),e.read!==void 0&&s(t,"response",l=>{let C=o(e.read,u,"read");s(l,"end",C)}),g}function kr(t){t=t;let e={protocol:t.protocol,hostname:d.string(t.hostname)&&t.hostname.startsWith("[")?t.hostname.slice(1,-1):t.hostname,host:t.host,hash:t.hash,search:t.search,pathname:t.pathname,href:t.href,path:`${t.pathname||""}${t.search||""}`};return d.string(t.port)&&t.port.length>0&&(e.port=Number(t.port)),(t.username||t.password)&&(e.auth=`${t.username||""}:${t.password||""}`),e}var lt=class{constructor(){Object.defineProperty(this,"weakMap",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"map",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.weakMap=new WeakMap,this.map=new Map}set(e,r){typeof e=="object"?this.weakMap.set(e,r):this.map.set(e,r)}get(e){return typeof e=="object"?this.weakMap.get(e):this.map.get(e)}has(e){return typeof e=="object"?this.weakMap.has(e):this.map.has(e)}};var Sa=({attemptCount:t,retryOptions:e,error:r,retryAfter:n,computedValue:s})=>{if(r.name==="RetryError")return 1;if(t>e.limit)return 0;let i=e.methods.includes(r.options.method),o=e.errorCodes.includes(r.code),a=r.response&&e.statusCodes.includes(r.response.statusCode);if(!i||!o&&!a)return 0;if(r.response){if(n)return n>s?0:n;if(r.response.statusCode===413)return 0}let h=Math.random()*e.noise;return Math.min(2**(t-1)*1e3,e.backoffLimit)+h},xs=Sa;var Li=N(require("node:process"),1),wt=require("node:util"),Ni=require("node:tls"),vi=N(require("node:http"),1),Di=N(require("node:https"),1);var re=require("node:dns"),qt=require("node:util"),Rs=N(require("node:os"),1),{Resolver:Ss}=re.promises,Me=Symbol("cacheableLookupCreateConnection"),Ur=Symbol("cacheableLookupInstance"),Os=Symbol("expires"),Oa=typeof re.ALL=="number",Cs=t=>{if(!(t&&typeof t.createConnection=="function"))throw new Error("Expected an Agent instance as the first argument")},Ca=t=>{for(let e of t)e.family!==6&&(e.address=`::ffff:${e.address}`,e.family=6)},Is=()=>{let t=!1,e=!1;for(let r of Object.values(Rs.default.networkInterfaces()))for(let n of r)if(!n.internal&&(n.family==="IPv6"?e=!0:t=!0,t&&e))return{has4:t,has6:e};return{has4:t,has6:e}},Ia=t=>Symbol.iterator in t,Bt=t=>t.catch(e=>{if(e.code==="ENODATA"||e.code==="ENOTFOUND"||e.code==="ENOENT")return[];throw e}),Ts={ttl:!0},Ta={all:!0},Ra={all:!0,family:4},Pa={all:!0,family:6},mt=class{constructor({cache:e=new Map,maxTtl:r=1/0,fallbackDuration:n=3600,errorTtl:s=.15,resolver:i=new Ss,lookup:o=re.lookup}={}){if(this.maxTtl=r,this.errorTtl=s,this._cache=e,this._resolver=i,this._dnsLookup=o&&(0,qt.promisify)(o),this.stats={cache:0,query:0},this._resolver instanceof Ss?(this._resolve4=this._resolver.resolve4.bind(this._resolver),this._resolve6=this._resolver.resolve6.bind(this._resolver)):(this._resolve4=(0,qt.promisify)(this._resolver.resolve4.bind(this._resolver)),this._resolve6=(0,qt.promisify)(this._resolver.resolve6.bind(this._resolver))),this._iface=Is(),this._pending={},this._nextRemovalTime=!1,this._hostnamesToFallback=new Set,this.fallbackDuration=n,n>0){let a=setInterval(()=>{this._hostnamesToFallback.clear()},n*1e3);a.unref&&a.unref(),this._fallbackInterval=a}this.lookup=this.lookup.bind(this),this.lookupAsync=this.lookupAsync.bind(this)}set servers(e){this.clear(),this._resolver.setServers(e)}get servers(){return this._resolver.getServers()}lookup(e,r,n){if(typeof r=="function"?(n=r,r={}):typeof r=="number"&&(r={family:r}),!n)throw new Error("Callback must be a function.");this.lookupAsync(e,r).then(s=>{r.all?n(null,s):n(null,s.address,s.family,s.expires,s.ttl,s.source)},n)}async lookupAsync(e,r={}){typeof r=="number"&&(r={family:r});let n=await this.query(e);if(r.family===6){let s=n.filter(i=>i.family===6);r.hints&re.V4MAPPED&&(Oa&&r.hints&re.ALL||s.length===0)?Ca(n):n=s}else r.family===4&&(n=n.filter(s=>s.family===4));if(r.hints&re.ADDRCONFIG){let{_iface:s}=this;n=n.filter(i=>i.family===6?s.has6:s.has4)}if(n.length===0){let s=new Error(`cacheableLookup ENOTFOUND ${e}`);throw s.code="ENOTFOUND",s.hostname=e,s}return r.all?n:n[0]}async query(e){let r="cache",n=await this._cache.get(e);if(n&&this.stats.cache++,!n){let s=this._pending[e];if(s)this.stats.cache++,n=await s;else{r="query";let i=this.queryAndCache(e);this._pending[e]=i,this.stats.query++;try{n=await i}finally{delete this._pending[e]}}}return n=n.map(s=>({...s,source:r})),n}async _resolve(e){let[r,n]=await Promise.all([Bt(this._resolve4(e,Ts)),Bt(this._resolve6(e,Ts))]),s=0,i=0,o=0,a=Date.now();for(let h of r)h.family=4,h.expires=a+h.ttl*1e3,s=Math.max(s,h.ttl);for(let h of n)h.family=6,h.expires=a+h.ttl*1e3,i=Math.max(i,h.ttl);return r.length>0?n.length>0?o=Math.min(s,i):o=s:o=i,{entries:[...r,...n],cacheTtl:o}}async _lookup(e){try{let[r,n]=await Promise.all([Bt(this._dnsLookup(e,Ra)),Bt(this._dnsLookup(e,Pa))]);return{entries:[...r,...n],cacheTtl:0}}catch{return{entries:[],cacheTtl:0}}}async _set(e,r,n){if(this.maxTtl>0&&n>0){n=Math.min(n,this.maxTtl)*1e3,r[Os]=Date.now()+n;try{await this._cache.set(e,r,n)}catch(s){this.lookupAsync=async()=>{let i=new Error("Cache Error. Please recreate the CacheableLookup instance.");throw i.cause=s,i}}Ia(this._cache)&&this._tick(n)}}async queryAndCache(e){if(this._hostnamesToFallback.has(e))return this._dnsLookup(e,Ta);let r=await this._resolve(e);r.entries.length===0&&this._dnsLookup&&(r=await this._lookup(e),r.entries.length!==0&&this.fallbackDuration>0&&this._hostnamesToFallback.add(e));let n=r.entries.length===0?this.errorTtl:r.cacheTtl;return await this._set(e,r.entries,n),r.entries}_tick(e){let r=this._nextRemovalTime;(!r||e<r)&&(clearTimeout(this._removalTimeout),this._nextRemovalTime=e,this._removalTimeout=setTimeout(()=>{this._nextRemovalTime=!1;let n=1/0,s=Date.now();for(let[i,o]of this._cache){let a=o[Os];s>=a?this._cache.delete(i):a<n&&(n=a)}n!==1/0&&this._tick(n-s)},e),this._removalTimeout.unref&&this._removalTimeout.unref())}install(e){if(Cs(e),Me in e)throw new Error("CacheableLookup has been already installed");e[Me]=e.createConnection,e[Ur]=this,e.createConnection=(r,n)=>("lookup"in r||(r.lookup=this.lookup),e[Me](r,n))}uninstall(e){if(Cs(e),e[Me]){if(e[Ur]!==this)throw new Error("The agent is not owned by this CacheableLookup instance");e.createConnection=e[Me],delete e[Me],delete e[Ur]}}updateInterfaceInfo(){let{_iface:e}=this;this._iface=Is(),(e.has4&&!this._iface.has4||e.has6&&!this._iface.has6)&&this._cache.clear()}clear(e){if(e){this._cache.delete(e);return}this._cache.clear()}};var Hi=N(Ai(),1);function rn(t){let e=[],r=t.split(",");for(let n of r){let[s,...i]=n.split(";"),o=s.trim();if(o[0]!=="<"||o[o.length-1]!==">")throw new Error(`Invalid format of the Link header reference: ${o}`);let a=o.slice(1,-1),h={};if(i.length===0)throw new Error(`Unexpected end of Link header parameters: ${i.join(";")}`);for(let u of i){let g=u.trim(),S=g.indexOf("=");if(S===-1)throw new Error(`Failed to parse Link header: ${t}`);let y=g.slice(0,S).trim(),w=g.slice(S+1).trim();h[y]=w}e.push({reference:a,parameters:h})}return e}var[ki,Jc]=Li.default.versions.node.split(".").map(Number);function Xc(t){for(let e in t){let r=t[e];m.any([d.string,d.number,d.boolean,d.null_,d.undefined],r)}}var Zc=new Map,Gt,ed=()=>Gt||(Gt=new mt,Gt),td={request:void 0,agent:{http:void 0,https:void 0,http2:void 0},h2session:void 0,decompress:!0,timeout:{connect:void 0,lookup:void 0,read:void 0,request:void 0,response:void 0,secureConnect:void 0,send:void 0,socket:void 0},prefixUrl:"",body:void 0,form:void 0,json:void 0,cookieJar:void 0,ignoreInvalidCookies:!1,searchParams:void 0,dnsLookup:void 0,dnsCache:void 0,context:{},hooks:{init:[],beforeRequest:[],beforeError:[],beforeRedirect:[],beforeRetry:[],afterResponse:[]},followRedirect:!0,maxRedirects:10,cache:void 0,throwHttpErrors:!0,username:"",password:"",http2:!1,allowGetBody:!1,headers:{"user-agent":"got (https://github.com/sindresorhus/got)"},methodRewriting:!1,dnsLookupIpVersion:void 0,parseJson:JSON.parse,stringifyJson:JSON.stringify,retry:{limit:2,methods:["GET","PUT","HEAD","DELETE","OPTIONS","TRACE"],statusCodes:[408,413,429,500,502,503,504,521,522,524],errorCodes:["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"],maxRetryAfter:void 0,calculateDelay:({computedValue:t})=>t,backoffLimit:Number.POSITIVE_INFINITY,noise:100},localAddress:void 0,method:"GET",createConnection:void 0,cacheOptions:{shared:void 0,cacheHeuristic:void 0,immutableMinTimeToLive:void 0,ignoreCargoCult:void 0},https:{alpnProtocols:void 0,rejectUnauthorized:void 0,checkServerIdentity:void 0,certificateAuthority:void 0,key:void 0,certificate:void 0,passphrase:void 0,pfx:void 0,ciphers:void 0,honorCipherOrder:void 0,minVersion:void 0,maxVersion:void 0,signatureAlgorithms:void 0,tlsSessionLifetime:void 0,dhparam:void 0,ecdhCurve:void 0,certificateRevocationLists:void 0},encoding:void 0,resolveBodyOnly:!1,isStream:!1,responseType:"text",url:void 0,pagination:{transform(t){return t.request.options.responseType==="json"?t.body:JSON.parse(t.body)},paginate({response:t}){let e=t.headers.link;if(typeof e!="string"||e.trim()==="")return!1;let n=rn(e).find(s=>s.parameters.rel==="next"||s.parameters.rel==='"next"');return n?{url:new URL(n.reference,t.url)}:!1},filter:()=>!0,shouldContinue:()=>!0,countLimit:Number.POSITIVE_INFINITY,backoff:0,requestLimit:1e4,stackAllItems:!1},setHost:!0,maxHeaderSize:void 0,signal:void 0,enableUnixSockets:!1},rd=t=>{let{hooks:e,retry:r}=t,n={...t,context:{...t.context},cacheOptions:{...t.cacheOptions},https:{...t.https},agent:{...t.agent},headers:{...t.headers},retry:{...r,errorCodes:[...r.errorCodes],methods:[...r.methods],statusCodes:[...r.statusCodes]},timeout:{...t.timeout},hooks:{init:[...e.init],beforeRequest:[...e.beforeRequest],beforeError:[...e.beforeError],beforeRedirect:[...e.beforeRedirect],beforeRetry:[...e.beforeRetry],afterResponse:[...e.afterResponse]},searchParams:t.searchParams?new URLSearchParams(t.searchParams):void 0,pagination:{...t.pagination}};return n.url!==void 0&&(n.prefixUrl=""),n},nd=t=>{let{hooks:e,retry:r}=t,n={...t};return d.object(t.context)&&(n.context={...t.context}),d.object(t.cacheOptions)&&(n.cacheOptions={...t.cacheOptions}),d.object(t.https)&&(n.https={...t.https}),d.object(t.cacheOptions)&&(n.cacheOptions={...n.cacheOptions}),d.object(t.agent)&&(n.agent={...t.agent}),d.object(t.headers)&&(n.headers={...t.headers}),d.object(r)&&(n.retry={...r},d.array(r.errorCodes)&&(n.retry.errorCodes=[...r.errorCodes]),d.array(r.methods)&&(n.retry.methods=[...r.methods]),d.array(r.statusCodes)&&(n.retry.statusCodes=[...r.statusCodes])),d.object(t.timeout)&&(n.timeout={...t.timeout}),d.object(e)&&(n.hooks={...e},d.array(e.init)&&(n.hooks.init=[...e.init]),d.array(e.beforeRequest)&&(n.hooks.beforeRequest=[...e.beforeRequest]),d.array(e.beforeError)&&(n.hooks.beforeError=[...e.beforeError]),d.array(e.beforeRedirect)&&(n.hooks.beforeRedirect=[...e.beforeRedirect]),d.array(e.beforeRetry)&&(n.hooks.beforeRetry=[...e.beforeRetry]),d.array(e.afterResponse)&&(n.hooks.afterResponse=[...e.afterResponse])),d.object(t.pagination)&&(n.pagination={...t.pagination}),n},sd=t=>{let e=[t.timeout.socket,t.timeout.connect,t.timeout.lookup,t.timeout.request,t.timeout.secureConnect].filter(r=>typeof r=="number");if(e.length>0)return Math.min(...e)},Ui=(t,e,r)=>{let n=t.hooks?.init;if(n)for(let s of n)s(e,r)},J=class t{constructor(e,r,n){if(Object.defineProperty(this,"_unixOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_internals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_merging",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_init",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),m.any([d.string,d.urlInstance,d.object,d.undefined],e),m.any([d.object,d.undefined],r),m.any([d.object,d.undefined],n),e instanceof t||r instanceof t)throw new TypeError("The defaults must be passed as the third argument");this._internals=rd(n?._internals??n??td),this._init=[...n?._init??[]],this._merging=!1,this._unixOptions=void 0;try{if(d.plainObject(e))try{this.merge(e),this.merge(r)}finally{this.url=e.url}else try{this.merge(r)}finally{if(r?.url!==void 0)if(e===void 0)this.url=r.url;else throw new TypeError("The `url` option is mutually exclusive with the `input` argument");else e!==void 0&&(this.url=e)}}catch(s){throw s.options=this,s}}merge(e){if(e){if(e instanceof t){for(let r of e._init)this.merge(r);return}e=nd(e),Ui(this,e,this),Ui(e,e,this),this._merging=!0,"isStream"in e&&(this.isStream=e.isStream);try{let r=!1;for(let n in e){if(n==="mutableDefaults"||n==="handlers"||n==="url")continue;if(!(n in this))throw new Error(`Unexpected option: ${n}`);let s=e[n];s!==void 0&&(this[n]=s,r=!0)}r&&this._init.push(e)}finally{this._merging=!1}}}get request(){return this._internals.request}set request(e){m.any([d.function_,d.undefined],e),this._internals.request=e}get agent(){return this._internals.agent}set agent(e){m.plainObject(e);for(let r in e){if(!(r in this._internals.agent))throw new TypeError(`Unexpected agent option: ${r}`);m.any([d.object,d.undefined],e[r])}this._merging?Object.assign(this._internals.agent,e):this._internals.agent={...e}}get h2session(){return this._internals.h2session}set h2session(e){this._internals.h2session=e}get decompress(){return this._internals.decompress}set decompress(e){m.boolean(e),this._internals.decompress=e}get timeout(){return this._internals.timeout}set timeout(e){m.plainObject(e);for(let r in e){if(!(r in this._internals.timeout))throw new Error(`Unexpected timeout option: ${r}`);m.any([d.number,d.undefined],e[r])}this._merging?Object.assign(this._internals.timeout,e):this._internals.timeout={...e}}get prefixUrl(){return this._internals.prefixUrl}set prefixUrl(e){if(m.any([d.string,d.urlInstance],e),e===""){this._internals.prefixUrl="";return}if(e=e.toString(),e.endsWith("/")||(e+="/"),this._internals.prefixUrl&&this._internals.url){let{href:r}=this._internals.url;this._internals.url.href=e+r.slice(this._internals.prefixUrl.length)}this._internals.prefixUrl=e}get body(){return this._internals.body}set body(e){m.any([d.string,d.buffer,d.nodeStream,d.generator,d.asyncGenerator,Fe,d.undefined],e),d.nodeStream(e)&&m.truthy(e.readable),e!==void 0&&(m.undefined(this._internals.form),m.undefined(this._internals.json)),this._internals.body=e}get form(){return this._internals.form}set form(e){m.any([d.plainObject,d.undefined],e),e!==void 0&&(m.undefined(this._internals.body),m.undefined(this._internals.json)),this._internals.form=e}get json(){return this._internals.json}set json(e){e!==void 0&&(m.undefined(this._internals.body),m.undefined(this._internals.form)),this._internals.json=e}get url(){return this._internals.url}set url(e){if(m.any([d.string,d.urlInstance,d.undefined],e),e===void 0){this._internals.url=void 0;return}if(d.string(e)&&e.startsWith("/"))throw new Error("`url` must not start with a slash");let r=`${this.prefixUrl}${e.toString()}`,n=new URL(r);if(this._internals.url=n,n.protocol==="unix:"&&(n.href=`http://unix${n.pathname}${n.search}`),n.protocol!=="http:"&&n.protocol!=="https:"){let s=new Error(`Unsupported protocol: ${n.protocol}`);throw s.code="ERR_UNSUPPORTED_PROTOCOL",s}if(this._internals.username&&(n.username=this._internals.username,this._internals.username=""),this._internals.password&&(n.password=this._internals.password,this._internals.password=""),this._internals.searchParams&&(n.search=this._internals.searchParams.toString(),this._internals.searchParams=void 0),n.hostname==="unix"){if(!this._internals.enableUnixSockets)throw new Error("Using UNIX domain sockets but option `enableUnixSockets` is not enabled");let s=/(?<socketPath>.+?):(?<path>.+)/.exec(`${n.pathname}${n.search}`);if(s?.groups){let{socketPath:i,path:o}=s.groups;this._unixOptions={socketPath:i,path:o,host:""}}else this._unixOptions=void 0;return}this._unixOptions=void 0}get cookieJar(){return this._internals.cookieJar}set cookieJar(e){if(m.any([d.object,d.undefined],e),e===void 0){this._internals.cookieJar=void 0;return}let{setCookie:r,getCookieString:n}=e;m.function_(r),m.function_(n),r.length===4&&n.length===0?(r=(0,wt.promisify)(r.bind(e)),n=(0,wt.promisify)(n.bind(e)),this._internals.cookieJar={setCookie:r,getCookieString:n}):this._internals.cookieJar=e}get signal(){return this._internals.signal}set signal(e){m.object(e),this._internals.signal=e}get ignoreInvalidCookies(){return this._internals.ignoreInvalidCookies}set ignoreInvalidCookies(e){m.boolean(e),this._internals.ignoreInvalidCookies=e}get searchParams(){return this._internals.url?this._internals.url.searchParams:(this._internals.searchParams===void 0&&(this._internals.searchParams=new URLSearchParams),this._internals.searchParams)}set searchParams(e){m.any([d.string,d.object,d.undefined],e);let r=this._internals.url;if(e===void 0){this._internals.searchParams=void 0,r&&(r.search="");return}let n=this.searchParams,s;if(d.string(e))s=new URLSearchParams(e);else if(e instanceof URLSearchParams)s=e;else{Xc(e),s=new URLSearchParams;for(let i in e){let o=e[i];o===null?s.append(i,""):o===void 0?n.delete(i):s.append(i,o)}}if(this._merging){for(let i of s.keys())n.delete(i);for(let[i,o]of s)n.append(i,o)}else r?r.search=n.toString():this._internals.searchParams=n}get searchParameters(){throw new Error("The `searchParameters` option does not exist. Use `searchParams` instead.")}set searchParameters(e){throw new Error("The `searchParameters` option does not exist. Use `searchParams` instead.")}get dnsLookup(){return this._internals.dnsLookup}set dnsLookup(e){m.any([d.function_,d.undefined],e),this._internals.dnsLookup=e}get dnsCache(){return this._internals.dnsCache}set dnsCache(e){m.any([d.object,d.boolean,d.undefined],e),e===!0?this._internals.dnsCache=ed():e===!1?this._internals.dnsCache=void 0:this._internals.dnsCache=e}get context(){return this._internals.context}set context(e){m.object(e),this._merging?Object.assign(this._internals.context,e):this._internals.context={...e}}get hooks(){return this._internals.hooks}set hooks(e){m.object(e);for(let r in e){if(!(r in this._internals.hooks))throw new Error(`Unexpected hook event: ${r}`);let n=r,s=e[n];if(m.any([d.array,d.undefined],s),s)for(let i of s)m.function_(i);if(this._merging)s&&this._internals.hooks[n].push(...s);else{if(!s)throw new Error(`Missing hook event: ${r}`);this._internals.hooks[r]=[...s]}}}get followRedirect(){return this._internals.followRedirect}set followRedirect(e){m.boolean(e),this._internals.followRedirect=e}get followRedirects(){throw new TypeError("The `followRedirects` option does not exist. Use `followRedirect` instead.")}set followRedirects(e){throw new TypeError("The `followRedirects` option does not exist. Use `followRedirect` instead.")}get maxRedirects(){return this._internals.maxRedirects}set maxRedirects(e){m.number(e),this._internals.maxRedirects=e}get cache(){return this._internals.cache}set cache(e){m.any([d.object,d.string,d.boolean,d.undefined],e),e===!0?this._internals.cache=Zc:e===!1?this._internals.cache=void 0:this._internals.cache=e}get throwHttpErrors(){return this._internals.throwHttpErrors}set throwHttpErrors(e){m.boolean(e),this._internals.throwHttpErrors=e}get username(){let e=this._internals.url,r=e?e.username:this._internals.username;return decodeURIComponent(r)}set username(e){m.string(e);let r=this._internals.url,n=encodeURIComponent(e);r?r.username=n:this._internals.username=n}get password(){let e=this._internals.url,r=e?e.password:this._internals.password;return decodeURIComponent(r)}set password(e){m.string(e);let r=this._internals.url,n=encodeURIComponent(e);r?r.password=n:this._internals.password=n}get http2(){return this._internals.http2}set http2(e){m.boolean(e),this._internals.http2=e}get allowGetBody(){return this._internals.allowGetBody}set allowGetBody(e){m.boolean(e),this._internals.allowGetBody=e}get headers(){return this._internals.headers}set headers(e){m.plainObject(e),this._merging?Object.assign(this._internals.headers,$e(e)):this._internals.headers=$e(e)}get methodRewriting(){return this._internals.methodRewriting}set methodRewriting(e){m.boolean(e),this._internals.methodRewriting=e}get dnsLookupIpVersion(){return this._internals.dnsLookupIpVersion}set dnsLookupIpVersion(e){if(e!==void 0&&e!==4&&e!==6)throw new TypeError(`Invalid DNS lookup IP version: ${e}`);this._internals.dnsLookupIpVersion=e}get parseJson(){return this._internals.parseJson}set parseJson(e){m.function_(e),this._internals.parseJson=e}get stringifyJson(){return this._internals.stringifyJson}set stringifyJson(e){m.function_(e),this._internals.stringifyJson=e}get retry(){return this._internals.retry}set retry(e){if(m.plainObject(e),m.any([d.function_,d.undefined],e.calculateDelay),m.any([d.number,d.undefined],e.maxRetryAfter),m.any([d.number,d.undefined],e.limit),m.any([d.array,d.undefined],e.methods),m.any([d.array,d.undefined],e.statusCodes),m.any([d.array,d.undefined],e.errorCodes),m.any([d.number,d.undefined],e.noise),e.noise&&Math.abs(e.noise)>100)throw new Error(`The maximum acceptable retry noise is +/- 100ms, got ${e.noise}`);for(let n in e)if(!(n in this._internals.retry))throw new Error(`Unexpected retry option: ${n}`);this._merging?Object.assign(this._internals.retry,e):this._internals.retry={...e};let{retry:r}=this._internals;r.methods=[...new Set(r.methods.map(n=>n.toUpperCase()))],r.statusCodes=[...new Set(r.statusCodes)],r.errorCodes=[...new Set(r.errorCodes)]}get localAddress(){return this._internals.localAddress}set localAddress(e){m.any([d.string,d.undefined],e),this._internals.localAddress=e}get method(){return this._internals.method}set method(e){m.string(e),this._internals.method=e.toUpperCase()}get createConnection(){return this._internals.createConnection}set createConnection(e){m.any([d.function_,d.undefined],e),this._internals.createConnection=e}get cacheOptions(){return this._internals.cacheOptions}set cacheOptions(e){m.plainObject(e),m.any([d.boolean,d.undefined],e.shared),m.any([d.number,d.undefined],e.cacheHeuristic),m.any([d.number,d.undefined],e.immutableMinTimeToLive),m.any([d.boolean,d.undefined],e.ignoreCargoCult);for(let r in e)if(!(r in this._internals.cacheOptions))throw new Error(`Cache option \`${r}\` does not exist`);this._merging?Object.assign(this._internals.cacheOptions,e):this._internals.cacheOptions={...e}}get https(){return this._internals.https}set https(e){m.plainObject(e),m.any([d.boolean,d.undefined],e.rejectUnauthorized),m.any([d.function_,d.undefined],e.checkServerIdentity),m.any([d.string,d.object,d.array,d.undefined],e.certificateAuthority),m.any([d.string,d.object,d.array,d.undefined],e.key),m.any([d.string,d.object,d.array,d.undefined],e.certificate),m.any([d.string,d.undefined],e.passphrase),m.any([d.string,d.buffer,d.array,d.undefined],e.pfx),m.any([d.array,d.undefined],e.alpnProtocols),m.any([d.string,d.undefined],e.ciphers),m.any([d.string,d.buffer,d.undefined],e.dhparam),m.any([d.string,d.undefined],e.signatureAlgorithms),m.any([d.string,d.undefined],e.minVersion),m.any([d.string,d.undefined],e.maxVersion),m.any([d.boolean,d.undefined],e.honorCipherOrder),m.any([d.number,d.undefined],e.tlsSessionLifetime),m.any([d.string,d.undefined],e.ecdhCurve),m.any([d.string,d.buffer,d.array,d.undefined],e.certificateRevocationLists);for(let r in e)if(!(r in this._internals.https))throw new Error(`HTTPS option \`${r}\` does not exist`);this._merging?Object.assign(this._internals.https,e):this._internals.https={...e}}get encoding(){return this._internals.encoding}set encoding(e){if(e===null)throw new TypeError("To get a Buffer, set `options.responseType` to `buffer` instead");m.any([d.string,d.undefined],e),this._internals.encoding=e}get resolveBodyOnly(){return this._internals.resolveBodyOnly}set resolveBodyOnly(e){m.boolean(e),this._internals.resolveBodyOnly=e}get isStream(){return this._internals.isStream}set isStream(e){m.boolean(e),this._internals.isStream=e}get responseType(){return this._internals.responseType}set responseType(e){if(e===void 0){this._internals.responseType="text";return}if(e!=="text"&&e!=="buffer"&&e!=="json")throw new Error(`Invalid \`responseType\` option: ${e}`);this._internals.responseType=e}get pagination(){return this._internals.pagination}set pagination(e){m.object(e),this._merging?Object.assign(this._internals.pagination,e):this._internals.pagination=e}get auth(){throw new Error("Parameter `auth` is deprecated. Use `username` / `password` instead.")}set auth(e){throw new Error("Parameter `auth` is deprecated. Use `username` / `password` instead.")}get setHost(){return this._internals.setHost}set setHost(e){m.boolean(e),this._internals.setHost=e}get maxHeaderSize(){return this._internals.maxHeaderSize}set maxHeaderSize(e){m.any([d.number,d.undefined],e),this._internals.maxHeaderSize=e}get enableUnixSockets(){return this._internals.enableUnixSockets}set enableUnixSockets(e){m.boolean(e),this._internals.enableUnixSockets=e}toJSON(){return{...this._internals}}[Symbol.for("nodejs.util.inspect.custom")](e,r){return(0,wt.inspect)(this._internals,r)}createNativeRequestOptions(){let e=this._internals,r=e.url,n;r.protocol==="https:"?n=e.http2?e.agent:e.agent.https:n=e.agent.http;let{https:s}=e,{pfx:i}=s;return d.array(i)&&d.plainObject(i[0])&&(i=i.map(o=>({buf:o.buffer,passphrase:o.passphrase}))),{...e.cacheOptions,...this._unixOptions,ALPNProtocols:s.alpnProtocols,ca:s.certificateAuthority,cert:s.certificate,key:s.key,passphrase:s.passphrase,pfx:s.pfx,rejectUnauthorized:s.rejectUnauthorized,checkServerIdentity:s.checkServerIdentity??Ni.checkServerIdentity,ciphers:s.ciphers,honorCipherOrder:s.honorCipherOrder,minVersion:s.minVersion,maxVersion:s.maxVersion,sigalgs:s.signatureAlgorithms,sessionTimeout:s.tlsSessionLifetime,dhparam:s.dhparam,ecdhCurve:s.ecdhCurve,crl:s.certificateRevocationLists,lookup:e.dnsLookup??e.dnsCache?.lookup,family:e.dnsLookupIpVersion,agent:n,setHost:e.setHost,method:e.method,maxHeaderSize:e.maxHeaderSize,localAddress:e.localAddress,headers:e.headers,createConnection:e.createConnection,timeout:e.http2?sd(e):void 0,h2session:e.h2session}}getRequestFunction(){let e=this._internals.url,{request:r}=this._internals;return!r&&e?this.getFallbackRequestFunction():r}getFallbackRequestFunction(){let e=this._internals.url;if(e){if(e.protocol==="https:"){if(this._internals.http2){if(ki<15||ki===15&&Jc<10){let r=new Error("To use the `http2` option, install Node.js 15.10.0 or above");throw r.code="EUNSUPPORTED",r}return Hi.default.auto}return Di.default.request}return vi.default.request}}freeze(){let e=this._internals;Object.freeze(e),Object.freeze(e.hooks),Object.freeze(e.hooks.afterResponse),Object.freeze(e.hooks.beforeError),Object.freeze(e.hooks.beforeRedirect),Object.freeze(e.hooks.beforeRequest),Object.freeze(e.hooks.beforeRetry),Object.freeze(e.hooks.init),Object.freeze(e.https),Object.freeze(e.cacheOptions),Object.freeze(e.agent),Object.freeze(e.headers),Object.freeze(e.timeout),Object.freeze(e.retry),Object.freeze(e.retry.errorCodes),Object.freeze(e.retry.methods),Object.freeze(e.retry.statusCodes)}};var Ke=t=>{let{statusCode:e}=t,r=t.request.options.followRedirect?299:399;return e>=200&&e<=r||e===304},Wt=class extends L{constructor(e,r){let{options:n}=r.request;super(`${e.message} in "${n.url.toString()}"`,e,r.request),this.name="ParseError",this.code="ERR_BODY_PARSE_FAILURE"}},nn=(t,e,r,n)=>{let{rawBody:s}=t;try{if(e==="text")return s.toString(n);if(e==="json")return s.length===0?"":r(s.toString(n));if(e==="buffer")return s}catch(i){throw new Wt(i,t)}throw new Wt({message:`Unknown body type '${e}'`,name:"Error"},t)};function id(t){return t.writable&&!t.writableEnded}var Bi=id;function Kt(t){return t.protocol==="unix:"||t.hostname==="unix"}var{buffer:od}=$i.default,ad=d.string(on.default.versions.brotli),cd=new Set(["GET","HEAD"]),sn=new lt,dd=new Set([300,301,302,303,304,307,308]),hd=["socket","connect","continue","information","upgrade"],Yt=()=>{},De=class t extends qi.Duplex{constructor(e,r,n){super({autoDestroy:!1,highWaterMark:0}),Object.defineProperty(this,"constructor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_noPipe",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"requestUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"redirectUrls",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"retryCount",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_stopRetry",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downloadedSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_uploadedSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_stopReading",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pipedServerResponses",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_responseSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bodySize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_unproxyEvents",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_isFromCache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_cannotHaveBody",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_triggerRead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_cancelTimeouts",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_removeListeners",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nativeResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_flushed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_aborted",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_requestInitialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._downloadedSize=0,this._uploadedSize=0,this._stopReading=!1,this._pipedServerResponses=new Set,this._cannotHaveBody=!1,this._unproxyEvents=Yt,this._triggerRead=!1,this._cancelTimeouts=Yt,this._removeListeners=Yt,this._jobs=[],this._flushed=!1,this._requestInitialized=!1,this._aborted=!1,this.redirectUrls=[],this.retryCount=0,this._stopRetry=Yt,this.on("pipe",i=>{i?.headers&&Object.assign(this.options.headers,i.headers)}),this.on("newListener",i=>{if(i==="retry"&&this.listenerCount("retry")>0)throw new Error("A retry listener has been attached already.")});try{if(this.options=new J(e,r,n),!this.options.url){if(this.options.prefixUrl==="")throw new TypeError("Missing `url` property");this.options.url=""}this.requestUrl=this.options.url}catch(i){let{options:o}=i;o&&(this.options=o),this.flush=async()=>{this.flush=async()=>{},this.destroy(i)};return}let{body:s}=this.options;if(d.nodeStream(s)&&s.once("error",i=>{this._flushed?this._beforeError(new Xe(i,this)):this.flush=async()=>{this.flush=async()=>{},this._beforeError(new Xe(i,this))}}),this.options.signal){let i=()=>{this.destroy(new Pt(this))};this.options.signal.aborted?i():(this.options.signal.addEventListener("abort",i),this._removeListeners=()=>{this.options.signal?.removeEventListener("abort",i)})}}async flush(){if(!this._flushed){this._flushed=!0;try{if(await this._finalizeBody(),this.destroyed)return;if(await this._makeRequest(),this.destroyed){this._request?.destroy();return}for(let e of this._jobs)e();this._jobs.length=0,this._requestInitialized=!0}catch(e){this._beforeError(e)}}}_beforeError(e){if(this._stopReading)return;let{response:r,options:n}=this,s=this.retryCount+(e.name==="RetryError"?0:1);this._stopReading=!0,e instanceof L||(e=new L(e.message,e,this));let i=e;(async()=>{if(r?.readable&&!r.rawBody&&!this._request?.socket?.destroyed&&(r.setEncoding(this.readableEncoding),await this._setRawBody(r)&&(r.body=r.rawBody.toString())),this.listenerCount("retry")!==0){let o;try{let a;r&&"retry-after"in r.headers&&(a=Number(r.headers["retry-after"]),Number.isNaN(a)?(a=Date.parse(r.headers["retry-after"])-Date.now(),a<=0&&(a=1)):a*=1e3);let h=n.retry;o=await h.calculateDelay({attemptCount:s,retryOptions:h,error:i,retryAfter:a,computedValue:xs({attemptCount:s,retryOptions:h,error:i,retryAfter:a,computedValue:h.maxRetryAfter??n.timeout.request??Number.POSITIVE_INFINITY})})}catch(a){this._error(new L(a.message,a,this));return}if(o){if(await new Promise(a=>{let h=setTimeout(a,o);this._stopRetry=()=>{clearTimeout(h),a()}}),this.destroyed)return;try{for(let a of this.options.hooks.beforeRetry)await a(i,this.retryCount+1)}catch(a){this._error(new L(a.message,e,this));return}if(this.destroyed)return;this.destroy(),this.emit("retry",this.retryCount+1,e,a=>{let h=new t(n.url,a,n);return h.retryCount=this.retryCount+1,on.default.nextTick(()=>{h.flush()}),h});return}}this._error(i)})()}_read(){this._triggerRead=!0;let{response:e}=this;if(e&&!this._stopReading){e.readableLength&&(this._triggerRead=!1);let r;for(;(r=e.read())!==null;){this._downloadedSize+=r.length;let n=this.downloadProgress;n.percent<1&&this.emit("downloadProgress",n),this.push(r)}}}_write(e,r,n){let s=()=>{this._writeRequest(e,r,n)};this._requestInitialized?s():this._jobs.push(s)}_final(e){let r=()=>{if(!this._request||this._request.destroyed){e();return}this._request.end(n=>{this._request._writableState?.errored||(n||(this._bodySize=this._uploadedSize,this.emit("uploadProgress",this.uploadProgress),this._request.emit("upload-complete")),e(n))})};this._requestInitialized?r():this._jobs.push(r)}_destroy(e,r){if(this._stopReading=!0,this.flush=async()=>{},this._stopRetry(),this._cancelTimeouts(),this._removeListeners(),this.options){let{body:n}=this.options;d.nodeStream(n)&&n.destroy()}this._request&&this._request.destroy(),e!==null&&!d.undefined(e)&&!(e instanceof L)&&(e=new L(e.message,e,this)),r(e)}pipe(e,r){return e instanceof bt.ServerResponse&&this._pipedServerResponses.add(e),super.pipe(e,r)}unpipe(e){return e instanceof bt.ServerResponse&&this._pipedServerResponses.delete(e),super.unpipe(e),this}async _finalizeBody(){let{options:e}=this,{headers:r}=e,n=!d.undefined(e.form),s=!d.undefined(e.json),i=!d.undefined(e.body),o=cd.has(e.method)&&!(e.method==="GET"&&e.allowGetBody);if(this._cannotHaveBody=o,n||s||i){if(o)throw new TypeError(`The \`${e.method}\` method cannot be used with a body`);let a=!d.string(r["content-type"]);if(i){if(Fe(e.body)){let u=new Ht(e.body);a&&(r["content-type"]=u.headers["Content-Type"]),"Content-Length"in u.headers&&(r["content-length"]=u.headers["Content-Length"]),e.body=u.encode()}dt(e.body)&&a&&(r["content-type"]=`multipart/form-data; boundary=${e.body.getBoundary()}`)}else if(n){a&&(r["content-type"]="application/x-www-form-urlencoded");let{form:u}=e;e.form=void 0,e.body=new URLSearchParams(u).toString()}else{a&&(r["content-type"]="application/json");let{json:u}=e;e.json=void 0,e.body=e.stringifyJson(u)}let h=await Rr(e.body,e.headers);d.undefined(r["content-length"])&&d.undefined(r["transfer-encoding"])&&!o&&!d.undefined(h)&&(r["content-length"]=String(h))}e.responseType==="json"&&!("accept"in e.headers)&&(e.headers.accept="application/json"),this._bodySize=Number(r["content-length"])||void 0}async _onResponseBase(e){if(this.isAborted)return;let{options:r}=this,{url:n}=r;this._nativeResponse=e,r.decompress&&(e=(0,ji.default)(e));let s=e.statusCode,i=e;i.statusMessage=i.statusMessage??bt.default.STATUS_CODES[s],i.url=r.url.toString(),i.requestUrl=this.requestUrl,i.redirectUrls=this.redirectUrls,i.request=this,i.isFromCache=this._nativeResponse.fromCache??!1,i.ip=this.ip,i.retryCount=this.retryCount,i.ok=Ke(i),this._isFromCache=i.isFromCache,this._responseSize=Number(e.headers["content-length"])||void 0,this.response=i,e.once("end",()=>{this._responseSize=this._downloadedSize,this.emit("downloadProgress",this.downloadProgress)}),e.once("error",a=>{this._aborted=!0,e.destroy(),this._beforeError(new Ze(a,this))}),e.once("aborted",()=>{this._aborted=!0,this._beforeError(new Ze({name:"Error",message:"The server aborted pending request",code:"ECONNRESET"},this))}),this.emit("downloadProgress",this.downloadProgress);let o=e.headers["set-cookie"];if(d.object(r.cookieJar)&&o){let a=o.map(async h=>r.cookieJar.setCookie(h,n.toString()));r.ignoreInvalidCookies&&(a=a.map(async h=>{try{await h}catch{}}));try{await Promise.all(a)}catch(h){this._beforeError(h);return}}if(!this.isAborted){if(r.followRedirect&&e.headers.location&&dd.has(s)){if(e.resume(),this._cancelTimeouts(),this._unproxyEvents(),this.redirectUrls.length>=r.maxRedirects){this._beforeError(new Ct(this));return}this._request=void 0;let a=new J(void 0,void 0,this.options),h=s===303&&a.method!=="GET"&&a.method!=="HEAD",u=s!==307&&s!==308,g=a.methodRewriting&&u;(h||g)&&(a.method="GET",a.body=void 0,a.json=void 0,a.form=void 0,delete a.headers["content-length"]);try{let S=Qt.Buffer.from(e.headers.location,"binary").toString(),y=new URL(S,n);if(!Kt(n)&&Kt(y)){this._beforeError(new L("Cannot redirect to UNIX socket",{},this));return}y.hostname!==n.hostname||y.port!==n.port?("host"in a.headers&&delete a.headers.host,"cookie"in a.headers&&delete a.headers.cookie,"authorization"in a.headers&&delete a.headers.authorization,(a.username||a.password)&&(a.username="",a.password="")):(y.username=a.username,y.password=a.password),this.redirectUrls.push(y),a.prefixUrl="",a.url=y;for(let w of a.hooks.beforeRedirect)await w(a,i);this.emit("redirect",a,i),this.options=a,await this._makeRequest()}catch(S){this._beforeError(S);return}return}if(r.isStream&&r.throwHttpErrors&&!Ke(i)){this._beforeError(new Ce(i));return}if(e.on("readable",()=>{this._triggerRead&&this._read()}),this.on("resume",()=>{e.resume()}),this.on("pause",()=>{e.pause()}),e.once("end",()=>{this.push(null)}),this._noPipe){await this._setRawBody()&&this.emit("response",e);return}this.emit("response",e);for(let a of this._pipedServerResponses)if(!a.headersSent){for(let h in e.headers){let u=r.decompress?h!=="content-encoding":!0,g=e.headers[h];u&&a.setHeader(h,g)}a.statusCode=s}}}async _setRawBody(e=this){if(e.readableEnded)return!1;try{let r=await od(e);if(!this.isAborted)return this.response.rawBody=r,!0}catch{}return!1}async _onResponse(e){try{await this._onResponseBase(e)}catch(r){this._beforeError(r)}}_onRequest(e){let{options:r}=this,{timeout:n,url:s}=r;Gn(e),this.options.http2&&e.setTimeout(0),this._cancelTimeouts=Ar(e,n,s);let i=r.cache?"cacheableResponse":"response";e.once(i,o=>{this._onResponse(o)}),e.once("error",o=>{this._aborted=!0,e.destroy(),o=o instanceof ut?new Tt(o,this.timings,this):new L(o.message,o,this),this._beforeError(o)}),this._unproxyEvents=ht(e,this,hd),this._request=e,this.emit("uploadProgress",this.uploadProgress),this._sendBody(),this.emit("request",e)}async _asyncWrite(e){return new Promise((r,n)=>{super.write(e,s=>{if(s){n(s);return}r()})})}_sendBody(){let{body:e}=this.options,r=this.redirectUrls.length===0?this:this._request??this;d.nodeStream(e)?e.pipe(r):d.generator(e)||d.asyncGenerator(e)?(async()=>{try{for await(let n of e)await this._asyncWrite(n);super.end()}catch(n){this._beforeError(n)}})():d.undefined(e)?(this._cannotHaveBody||this._noPipe)&&r.end():(this._writeRequest(e,void 0,()=>{}),r.end())}_prepareCache(e){if(!sn.has(e)){let r=new as((n,s)=>{let i=n._request(n,s);return d.promise(i)&&(i.once=(o,a)=>{if(o==="error")(async()=>{try{await i}catch(h){a(h)}})();else if(o==="abort")(async()=>{try{(await i).once("abort",a)}catch{}})();else throw new Error(`Unknown HTTP2 promise event: ${o}`);return i}),i},e);sn.set(e,r.request())}}async _createCacheableRequest(e,r){return new Promise((n,s)=>{Object.assign(r,kr(e));let i,o=sn.get(r.cache)(r,async a=>{if(a._readableState.autoDestroy=!1,i){let h=()=>{a.req&&(a.complete=a.req.res.complete)};a.prependOnceListener("end",h),h(),(await i).emit("cacheableResponse",a)}n(a)});o.once("error",s),o.once("request",async a=>{i=a,n(i)})})}async _makeRequest(){let{options:e}=this,{headers:r,username:n,password:s}=e,i=e.cookieJar;for(let u in r)if(d.undefined(r[u]))delete r[u];else if(d.null_(r[u]))throw new TypeError(`Use \`undefined\` instead of \`null\` to delete the \`${u}\` header`);if(e.decompress&&d.undefined(r["accept-encoding"])&&(r["accept-encoding"]=ad?"gzip, deflate, br":"gzip, deflate"),n||s){let u=Qt.Buffer.from(`${n}:${s}`).toString("base64");r.authorization=`Basic ${u}`}if(i){let u=await i.getCookieString(e.url.toString());d.nonEmptyString(u)&&(r.cookie=u)}e.prefixUrl="";let o;for(let u of e.hooks.beforeRequest){let g=await u(e);if(!d.undefined(g)){o=()=>g;break}}o||(o=e.getRequestFunction());let a=e.url;this._requestOptions=e.createNativeRequestOptions(),e.cache&&(this._requestOptions._request=o,this._requestOptions.cache=e.cache,this._requestOptions.body=e.body,this._prepareCache(e.cache));let h=e.cache?this._createCacheableRequest:o;try{let u=h(a,this._requestOptions);d.promise(u)&&(u=await u),d.undefined(u)&&(u=e.getFallbackRequestFunction()(a,this._requestOptions),d.promise(u)&&(u=await u)),Bi(u)?this._onRequest(u):this.writable?(this.once("finish",()=>{this._onResponse(u)}),this._sendBody()):this._onResponse(u)}catch(u){throw u instanceof xe?new It(u,this):u}}async _error(e){try{if(!(e instanceof Ce&&!this.options.throwHttpErrors))for(let r of this.options.hooks.beforeError)e=await r(e)}catch(r){e=new L(r.message,r,this)}this.destroy(e)}_writeRequest(e,r,n){!this._request||this._request.destroyed||this._request.write(e,r,s=>{if(!s&&!this._request.destroyed){this._uploadedSize+=Qt.Buffer.byteLength(e,r);let i=this.uploadProgress;i.percent<1&&this.emit("uploadProgress",i)}n(s)})}get ip(){return this.socket?.remoteAddress}get isAborted(){return this._aborted}get socket(){return this._request?.socket??void 0}get downloadProgress(){let e;return this._responseSize?e=this._downloadedSize/this._responseSize:this._responseSize===this._downloadedSize?e=1:e=0,{percent:e,transferred:this._downloadedSize,total:this._responseSize}}get uploadProgress(){let e;return this._bodySize?e=this._uploadedSize/this._bodySize:this._bodySize===this._uploadedSize?e=1:e=0,{percent:e,transferred:this._uploadedSize,total:this._bodySize}}get timings(){return this._request?.timings}get isFromCache(){return this._isFromCache}get reusedSocket(){return this._request?.reusedSocket}};var He=class extends L{constructor(e){super("Promise was canceled",{},e),this.name="CancelError",this.code="ERR_CANCELED"}get isCanceled(){return!0}};var ud=["request","response","redirect","uploadProgress","downloadProgress"];function Jt(t){let e,r,n,s=new zi.EventEmitter,i=new je((a,h,u)=>{u(()=>{e.destroy()}),u.shouldReject=!1,u(()=>{h(new He(e))});let g=S=>{u(()=>{});let y=t??new De(void 0,void 0,n);y.retryCount=S,y._noPipe=!0,e=y,y.once("response",async l=>{let C=(l.headers["content-encoding"]??"").toLowerCase(),_=C==="gzip"||C==="deflate"||C==="br",{options:R}=y;if(_&&!R.decompress)l.body=l.rawBody;else try{l.body=nn(l,R.responseType,R.parseJson,R.encoding)}catch(O){if(l.body=l.rawBody.toString(),Ke(l)){y._beforeError(O);return}}try{let O=R.hooks.afterResponse;for(let[P,D]of O.entries())if(l=await D(l,async V=>{throw R.merge(V),R.prefixUrl="",V.url&&(R.url=V.url),R.hooks.afterResponse=R.hooks.afterResponse.slice(0,P),new Rt(y)}),!(d.object(l)&&d.number(l.statusCode)&&!d.nullOrUndefined(l.body)))throw new TypeError("The `afterResponse` hook returned an invalid value")}catch(O){y._beforeError(O);return}if(r=l,!Ke(l)){y._beforeError(new Ce(l));return}y.destroy(),a(y.options.resolveBodyOnly?l.body:l)});let w=l=>{if(i.isCanceled)return;let{options:C}=y;if(l instanceof Ce&&!C.throwHttpErrors){let{response:_}=l;y.destroy(),a(y.options.resolveBodyOnly?_.body:_);return}h(l)};y.once("error",w);let b=y.options?.body;y.once("retry",(l,C)=>{t=void 0;let _=y.options.body;if(b===_&&d.nodeStream(_)){C.message="Cannot retry with consumed body stream",w(C);return}n=y.options,g(l)}),ht(y,s,ud),d.undefined(t)&&y.flush()};g(0)});i.on=(a,h)=>(s.on(a,h),i),i.off=(a,h)=>(s.off(a,h),i);let o=a=>{let h=(async()=>{await i;let{options:u}=r.request;return nn(r,a,u.parseJson,u.encoding)})();return Object.defineProperties(h,Object.getOwnPropertyDescriptors(i)),h};return i.json=()=>{if(e.options){let{headers:a}=e.options;!e.writableFinished&&!("accept"in a)&&(a.accept="application/json")}return o("json")},i.buffer=()=>o("buffer"),i.text=()=>o("text"),i}var ld=async t=>new Promise(e=>{setTimeout(e,t)}),md=t=>d.function_(t),pd=["get","post","put","patch","head","delete"],Fi=t=>{t={options:new J(void 0,void 0,t.options),handlers:[...t.handlers],mutableDefaults:t.mutableDefaults},Object.defineProperty(t,"mutableDefaults",{enumerable:!0,configurable:!1,writable:!1});let e=(n,s,i=t.options)=>{let o=new De(n,s,i),a,h=S=>(o.options=S,o._noPipe=!S.isStream,o.flush(),S.isStream?o:(a||(a=Jt(o)),a)),u=0,g=S=>{let w=(t.handlers[u++]??h)(S,g);if(d.promise(w)&&!o.options.isStream&&(a||(a=Jt(o)),w!==a)){let b=Object.getOwnPropertyDescriptors(a);for(let l in b)l in w&&delete b[l];Object.defineProperties(w,b),w.cancel=a.cancel}return w};return g(o.options)};e.extend=(...n)=>{let s=new J(void 0,void 0,t.options),i=[...t.handlers],o;for(let a of n)md(a)?(s.merge(a.defaults.options),i.push(...a.defaults.handlers),o=a.defaults.mutableDefaults):(s.merge(a),a.handlers&&i.push(...a.handlers),o=a.mutableDefaults);return Fi({options:s,handlers:i,mutableDefaults:!!o})};let r=async function*(n,s){let i=new J(n,s,t.options);i.resolveBodyOnly=!1;let{pagination:o}=i;m.function_(o.transform),m.function_(o.shouldContinue),m.function_(o.filter),m.function_(o.paginate),m.number(o.countLimit),m.number(o.requestLimit),m.number(o.backoff);let a=[],{countLimit:h}=o,u=0;for(;u<o.requestLimit;){u!==0&&await ld(o.backoff);let g=await e(void 0,void 0,i),S=await o.transform(g),y=[];m.array(S);for(let b of S)if(o.filter({item:b,currentItems:y,allItems:a})&&(!o.shouldContinue({item:b,currentItems:y,allItems:a})||(yield b,o.stackAllItems&&a.push(b),y.push(b),--h<=0)))return;let w=o.paginate({response:g,currentItems:y,allItems:a});if(w===!1)return;w===g.request.options?i=g.request.options:(i.merge(w),m.any([d.urlInstance,d.undefined],w.url),w.url!==void 0&&(i.prefixUrl="",i.url=w.url)),u++}};e.paginate=r,e.paginate.all=async(n,s)=>{let i=[];for await(let o of r(n,s))i.push(o);return i},e.paginate.each=r,e.stream=(n,s)=>e(n,{...s,isStream:!0});for(let n of pd)e[n]=(s,i)=>e(s,{...i,method:n}),e.stream[n]=(s,i)=>e(s,{...i,method:n,isStream:!0});return t.mutableDefaults||(Object.freeze(t.handlers),t.options.freeze()),Object.defineProperty(e,"defaults",{value:t,writable:!1,configurable:!1,enumerable:!0}),e},Mi=Fi;var yd={options:new J,handlers:[],mutableDefaults:!1},gd=Mi(yd),Vi=gd;var Gi="[a-fA-F\\d:]",Pe=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${Gi})|(?<=${Gi})(?=\\s|$))`:"",ne="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",v="[a-fA-F\\d]{1,4}",Xt=`
(?:
(?:${v}:){7}(?:${v}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${v}:){6}(?:${ne}|:${v}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${v}:){5}(?::${ne}|(?::${v}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${v}:){4}(?:(?::${v}){0,1}:${ne}|(?::${v}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${v}:){3}(?:(?::${v}){0,2}:${ne}|(?::${v}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${v}:){2}(?:(?::${v}){0,3}:${ne}|(?::${v}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${v}:){1}(?:(?::${v}){0,4}:${ne}|(?::${v}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${v}){0,5}:${ne}|(?::${v}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),fd=new RegExp(`(?:^${ne}$)|(?:^${Xt}$)`),_d=new RegExp(`^${ne}$`),wd=new RegExp(`^${Xt}$`),an=t=>t&&t.exact?fd:new RegExp(`(?:${Pe(t)}${ne}${Pe(t)})|(?:${Pe(t)}${Xt}${Pe(t)})`,"g");an.v4=t=>t&&t.exact?_d:new RegExp(`${Pe(t)}${ne}${Pe(t)}`,"g");an.v6=t=>t&&t.exact?wd:new RegExp(`${Pe(t)}${Xt}${Pe(t)}`,"g");var cn=an;var Wi=N(require("node:vm"),1);function dn(t,{timeout:e}={}){let r=new Wi.default.Script("returnValue = function_()"),n=(...s)=>{let i={function_:()=>t(...s)};return r.runInNewContext(i,{timeout:e}),i.returnValue};return Object.defineProperty(n,"name",{value:`functionTimeout(${t.name||"<anonymous>"})`,configurable:!0}),n}function Ki(t){return t?.code==="ERR_SCRIPT_EXECUTION_TIMEOUT"}var{toString:bd}=Object.prototype;function hn(t){return bd.call(t)==="[object RegExp]"}var Yi={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function un(t,e={}){if(!hn(t))throw new TypeError("Expected a RegExp instance");let r=Object.keys(Yi).map(s=>(typeof e[s]=="boolean"?e[s]:t[s])?Yi[s]:"").join(""),n=new RegExp(e.source||t.source,r);return n.lastIndex=typeof e.lastIndex=="number"?e.lastIndex:t.lastIndex,n}function ln(t,e,{timeout:r}={}){try{return dn(()=>un(t).test(e),{timeout:r})()}catch(n){if(Ki(n))return!1;throw n}}var Ed=15,xd=45,Qi={timeout:400};function mn(t){return t.length>xd?!1:ln(cn.v6({exact:!0}),t,Qi)}function pn(t){return t.length>Ed?!1:ln(cn.v4({exact:!0}),t,Qi)}var Ye=class extends Error{constructor(e){super("Could not get the public IP address",e),this.name="IpNotFoundError"}};function Ji(t,e){return function(n){let s=t(n),i=e(n),o=(async()=>{try{let a=await i;return s.catch(()=>{}),s.cancel(),a}catch(a){if(!(a instanceof Ye))throw a;try{return await s}catch(h){throw new AggregateError([h,a])}}})();return o.cancel=()=>{s.cancel(),i.cancel()},o}}var ro={timeout:5e3,onlyHttps:!1},Xi=[{v4:{servers:["208.67.222.222","208.67.220.220","208.67.222.220","208.67.220.222"],name:"myip.opendns.com",type:"A"},v6:{servers:["2620:0:ccc::2","2620:0:ccd::2"],name:"myip.opendns.com",type:"AAAA"}},{v4:{servers:["216.239.32.10","216.239.34.10","216.239.36.10","216.239.38.10"],name:"o-o.myaddr.l.google.com",type:"TXT",transform:t=>t.replaceAll('"',"")},v6:{servers:["2001:4860:4802:32::a","2001:4860:4802:34::a","2001:4860:4802:36::a","2001:4860:4802:38::a"],name:"o-o.myaddr.l.google.com",type:"TXT",transform:t=>t.replaceAll('"',"")}}],no={v4:{dnsServers:Xi.map(({v4:{servers:t,...e}})=>({servers:t,question:e})),httpsUrls:["https://icanhazip.com/","https://api.ipify.org/"]},v6:{dnsServers:Xi.map(({v6:{servers:t,...e}})=>({servers:t,question:e})),httpsUrls:["https://icanhazip.com/","https://api6.ipify.org/"]}},yn=(t,e)=>{let r=no[t],n=(0,to.default)({retries:0,maxQueries:1,socket:eo.default.createSocket(t==="v6"?"udp6":"udp4"),timeout:e.timeout}),s=(0,Zi.promisify)(n.query.bind(n)),i=(async()=>{let o;for(let a of r.dnsServers){let{servers:h,question:u}=a;for(let g of h){if(n.destroyed)return;try{let{name:S,type:y,transform:w}=u,b=await s({questions:[{name:S,type:y}]},53,g),{answers:{0:{data:l}}}=b,C=(typeof l=="string"?l:l.toString()).trim(),_=w?w(C):C;if(_&&(t==="v6"?mn:pn)(_))return n.destroy(),_}catch(S){o=S}}}throw n.destroy(),new Ye({cause:o})})();return i.cancel=()=>{n.destroy()},i},gn=(t,e)=>{let r,n=(async()=>{try{let s={dnsLookupIpVersion:t==="v6"?6:4,retry:{limit:0},timeout:{request:e.timeout}},i=[...no[t].httpsUrls,...e.fallbackUrls??[]],o;for(let a of i)try{let h=Vi.get(a,s);r=h.cancel;let g=(await h).body?.trim();if(g&&(t==="v6"?mn:pn)(g))return g}catch(h){if(o=h,h instanceof He)throw h}throw new Ye({cause:o})}catch(s){if(!(s instanceof He))throw s}})();return n.cancel=function(){return r.apply(this)},n},so=(t,e)=>{let r,n=(async()=>{let s,i=yn(t,e);r=i.cancel;try{s=await i}catch{let o=gn(t,e);r=o.cancel,s=await o}return s})();return n.cancel=r,n},jl=Ji(fn,_n);function fn(t){return t={...ro,...t},t.onlyHttps?t.onlyHttps?gn("v4",t):yn("v4",t):so("v4",t)}function _n(t){return t={...ro,...t},t.onlyHttps?t.onlyHttps?gn("v6",t):yn("v6",t):so("v6",t)}var Sd=async t=>{let{args:e}=Cn([t.arguments.ipType,t.arguments.ipVersion],["ipType","IpVersion"]),r=e[0]==="Public"?"Public":"Local",n=e[1]==="IPv6"?"IPv6":"IPv4";try{q.environment.launchType===q.LaunchType.UserInitiated&&await(0,q.closeMainWindow)();let s="";if(r==="Local"){let i;n==="IPv4"?i=Sn():i=On(),s=i||""}else{let i;n==="IPv4"?i=await fn({onlyHttps:!0}).then(o=>o).catch(()=>""):i=await _n({onlyHttps:!0}).then(o=>o).catch(()=>""),s=i||""}q.environment.launchType===q.LaunchType.UserInitiated&&(xn(s)?await(0,q.showHUD)(`\u{1F6A8} Failed to get ${r} ${n} `):(await q.Clipboard.copy(`${s}`),await(0,q.showHUD)(`\u{1F17F}\uFE0F ${r} ${n} ${s}`))),s?await(0,q.updateCommandMetadata)({subtitle:` ${r} ${n} ${s}`}):await(0,q.updateCommandMetadata)({subtitle:"IP Geolocation"})}catch(s){(0,q.captureException)(s),console.error(s)}};
